! ###################################################################
! Copyright (c) 2017-2022, Marc De Graef Research Group/Carnegie Mellon University
! All rights reserved.
!
! Redistribution and use in source and binary forms, with or without modification, are 
! permitted provided that the following conditions are met:
!
!     - Redistributions of source code must retain the above copyright notice, this list 
!        of conditions and the following disclaimer.
!     - Redistributions in binary form must reproduce the above copyright notice, this 
!        list of conditions and the following disclaimer in the documentation and/or 
!        other materials provided with the distribution.
!     - Neither the names of Marc De Graef, Carnegie Mellon University nor the names 
!        of its contributors may be used to endorse or promote products derived from 
!        this software without specific prior written permission.
!
! THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" 
! AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
! IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE 
! ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE 
! LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
! DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR 
! SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER 
! CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, 
! OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE 
! USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
! ###################################################################

!--------------------------------------------------------------------------
module MODRotationsTest
  !! author: MDG 
  !! version: 1.0 
  !! date: 01/19/20
  !!
  !! extensive testing of 43,200 pair and triplet rotation transformations for 75 rotations (double precision only)
  !!
  !! This file was generated by an IDL routine (mkRotationsTest.pro); do not edit by hand!!! 
  !!
  !! The current source code was generated on Mon Jan 20 18:16:39 2020
  !!

contains 

subroutine MODRotationsExecuteTest(res) &
           bind(c, name='MODRotationsExecuteTest')    ! this routine is callable from a C/C++ program
!DEC$ ATTRIBUTES DLLEXPORT :: MODRotationsExecuteTest

use mod_kinds
use mod_global
use mod_math
use mod_rotations
use mod_Lambert
use,INTRINSIC :: ISO_C_BINDING

IMPLICIT NONE

type(e_T)                       :: ine, oute, int1e, int2e
type(o_T)                       :: ino, outo, int1o, int2o
type(a_T)                       :: ina, outa, int1a, int2a
type(r_T)                       :: inr, outr, int1r, int2r
type(q_T)                       :: inq, outq, int1q, int2q
type(h_T)                       :: inh, outh, int1h, int2h
type(c_T)                       :: inc, outc, int1c, int2c
type(s_T)                       :: ins, outs, int1s, int2s
type(v_T)                       :: inv, outv, int1v, int2v
type(orientation_T)             :: ot
type(o_T)                       :: oo

integer(C_INT32_T),INTENT(OUT)  :: res

real(kind=dbl)                  :: iom(3,3), oom(3,3), omm(3,3), qd(4), qd2(4), ad(4), ad2(4), rd(4), rd2(4), &
                                   hd(3), ccd(3), sd(3), vd(3), diff, diffmax, aux, ivec(3)
real(kind=dbl),parameter        :: maxerr = 1.0D-8
integer(kind=irg)               :: tcnt, i,  numarg, testcounter, testsfailed
integer(kind=irg),parameter     :: rcnt = 75
character(fnlen)                :: arg
logical                         :: verbose

! list of 75 rotations that provide a good workout for the rotations module (lots of special cases) 
real(kind=dbl)        :: rots(3,rcnt) = reshape( (/ 0.D0,  0.D0, 0.0D0, &
                                                   90.D0,  0.D0, 0.0D0, &
                                                   180.D0,  0.D0, 0.0D0, &
                                                   270.D0,  0.D0, 0.0D0, &
                                                   360.D0,  0.D0, 0.0D0, &
                                                   0.D0, 90.D0, 0.0D0, &
                                                   90.D0, 90.D0, 0.0D0, &
                                                   180.D0, 90.D0, 0.0D0, &
                                                   270.D0, 90.D0, 0.0D0, &
                                                   0.D0,180.D0, 0.0D0, &
                                                   90.D0,180.D0, 0.0D0, &
                                                   180.D0,180.D0, 0.0D0, &
                                                   270.D0,180.D0, 0.0D0, &
                                                   360.D0,180.D0, 0.0D0, &
                                                   0.D0,  0.D0,90.0D0, &
                                                   90.D0,  0.D0,90.0D0, &
                                                   180.D0,  0.D0,90.0D0, &
                                                   270.D0,  0.D0,90.0D0, &
                                                   360.D0,  0.D0,90.0D0, &
                                                   0.D0, 90.D0,90.0D0, &
                                                   90.D0, 90.D0,90.0D0, &
                                                   180.D0, 90.D0,90.0D0, &
                                                   270.D0, 90.D0,90.0D0, &
                                                   360.D0, 90.D0,90.0D0, &
                                                   0.D0,180.D0,90.0D0, &
                                                   90.D0,180.D0,90.0D0, &
                                                   180.D0,180.D0,90.0D0, &
                                                   270.D0,180.D0,90.0D0, &
                                                   360.D0,180.D0,90.0D0, &
                                                   0.D0,  0.D0,180.0D0, &
                                                   90.D0,  0.D0,180.0D0, &
                                                   180.D0,  0.D0,180.0D0, &
                                                   270.D0,  0.D0,180.0D0, &
                                                   360.D0,  0.D0,180.0D0, &
                                                   0.D0, 90.D0,180.0D0, &
                                                   90.D0, 90.D0,180.0D0, &
                                                   180.D0, 90.D0,180.0D0, &
                                                   270.D0, 90.D0,180.0D0, &
                                                   360.D0, 90.D0,180.0D0, &
                                                   0.D0,180.D0,180.0D0, &
                                                   90.D0,180.D0,180.0D0, &
                                                   180.D0,180.D0,180.0D0, &
                                                   270.D0,180.D0,180.0D0, &
                                                   360.D0,180.D0,180.0D0, &
                                                   0.D0,  0.D0,270.0D0, &
                                                   90.D0,  0.D0,270.0D0, &
                                                   180.D0,  0.D0,270.0D0, &
                                                   270.D0,  0.D0,270.0D0, &
                                                   360.D0,  0.D0,270.0D0, &
                                                   0.D0, 90.D0,270.0D0, &
                                                   90.D0, 90.D0,270.0D0, &
                                                   180.D0, 90.D0,270.0D0, &
                                                   270.D0, 90.D0,270.0D0, &
                                                   360.D0, 90.D0,270.0D0, &
                                                   0.D0,180.D0,270.0D0, &
                                                   90.D0,180.D0,270.0D0, &
                                                   180.D0,180.D0,270.0D0, &
                                                   270.D0,180.D0,270.0D0, &
                                                   360.D0,180.D0,270.0D0, &
                                                   0.D0,  0.D0,360.0D0, &
                                                   90.D0,  0.D0,360.0D0, &
                                                   180.D0,  0.D0,360.0D0, &
                                                   270.D0,  0.D0,360.0D0, &
                                                   360.D0,  0.D0,360.0D0, &
                                                   0.D0, 90.D0,360.0D0, &
                                                   90.D0, 90.D0,360.0D0, &
                                                   180.D0, 90.D0,360.0D0, &
                                                   270.D0, 90.D0,360.0D0, &
                                                   360.D0, 90.D0,360.0D0, &
                                                   0.D0,180.D0,360.0D0, &
                                                   90.D0,180.D0,360.0D0, &
                                                   180.D0,180.D0,360.0D0, &
                                                   270.D0,180.D0,360.0D0, &
                                                   360.D0,180.D0,360.0D0, &
                                                   360.D0, 90.D0, 0.0D0 /), (/ 3, rcnt /) )



verbose = .FALSE.
ivec = (/ 1.D0, 1.D0, 0.D0 /)
testcounter = 0
testsfailed = 0
mainloop: do i=1,rcnt
! create the orientation class for a given Euler triplet
 ine = e_T( edinp = cvtoRadians(rots(1:3,i)) )
 ot = orientation_T( ine )
 if (verbose) write(*,*) '  '
 if (verbose) write(*,*) '----------------------------------------------------'
 if (verbose) call ot%print_orientation('d')
 
! individual tests  x = Oinv [ O [x] ]
 
  diffmax = 0.D0
tcnt = 0
if (verbose)  write (*,*) 'e test'
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1o = ine%eo()
  oute = int1o%oe()
  int1o = oute%eo()
  diff = maxval(abs(int1o%o_copyd()-ot%get_od()))
  if (verbose)   write (*,*) 'e%eo() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oe()-e%eo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1a = ine%ea()
  oute = int1a%ae()
  int1o = oute%eo()
  diff = maxval(abs(int1o%o_copyd()-ot%get_od()))
  if (verbose)   write (*,*) 'e%ea() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ae()-e%ea() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1r = ine%er()
  oute = int1r%re()
  int1o = oute%eo()
  diff = maxval(abs(int1o%o_copyd()-ot%get_od()))
  if (verbose)   write (*,*) 'e%er() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%re()-e%er() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1q = ine%eq()
  oute = int1q%qe()
  int1o = oute%eo()
  diff = maxval(abs(int1o%o_copyd()-ot%get_od()))
  if (verbose)   write (*,*) 'e%eq() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qe()-e%eq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1h = ine%eh()
  oute = int1h%he()
  int1o = oute%eo()
  diff = maxval(abs(int1o%o_copyd()-ot%get_od()))
  if (verbose)   write (*,*) 'e%eh() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%he()-e%eh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1c = ine%ec()
  oute = int1c%ce()
  int1o = oute%eo()
  diff = maxval(abs(int1o%o_copyd()-ot%get_od()))
  if (verbose)   write (*,*) 'e%ec() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ce()-e%ec() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1s = ine%es()
  oute = int1s%se()
  int1o = oute%eo()
  diff = maxval(abs(int1o%o_copyd()-ot%get_od()))
  if (verbose)   write (*,*) 'e%es() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%se()-e%es() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1v = ine%ev()
  oute = int1v%ve()
  int1o = oute%eo()
  diff = maxval(abs(int1o%o_copyd()-ot%get_od()))
  if (verbose)   write (*,*) 'e%ev() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%ve()-e%ev() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose)  write (*,*) 'o test'
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1e = ino%oe()
  outo = int1e%eo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)   write (*,*) 'o%oe() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eo()-o%oe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1a = ino%oa()
  outo = int1a%ao()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)   write (*,*) 'o%oa() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ao()-o%oa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1r = ino%or()
  outo = int1r%ro()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)   write (*,*) 'o%or() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ro()-o%or() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1q = ino%oq()
  outo = int1q%qo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)   write (*,*) 'o%oq() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qo()-o%oq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1h = ino%oh()
  outo = int1h%ho()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)   write (*,*) 'o%oh() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ho()-o%oh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1c = ino%oc()
  outo = int1c%co()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)   write (*,*) 'o%oc() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%co()-o%oc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1s = ino%os()
  outo = int1s%so()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)   write (*,*) 'o%os() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%so()-o%os() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1v = ino%ov()
  outo = int1v%vo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)   write (*,*) 'o%ov() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vo()-o%ov() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose)  write (*,*) 'a test'
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1e = ina%ae()
  outa = int1e%ea()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)   write (*,*) 'a%ae() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ea()-a%ae() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1o = ina%ao()
  outa = int1o%oa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)   write (*,*) 'a%ao() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oa()-a%ao() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1r = ina%ar()
  outa = int1r%ra()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)   write (*,*) 'a%ar() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ra()-a%ar() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1q = ina%aq()
  outa = int1q%qa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)   write (*,*) 'a%aq() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qa()-a%aq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1h = ina%ah()
  outa = int1h%ha()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)   write (*,*) 'a%ah() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ha()-a%ah() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1c = ina%ac()
  outa = int1c%ca()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)   write (*,*) 'a%ac() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ca()-a%ac() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1s = ina%as()
  outa = int1s%sa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)   write (*,*) 'a%as() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sa()-a%as() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1v = ina%av()
  outa = int1v%va()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)   write (*,*) 'a%av() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%va()-a%av() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose)  write (*,*) 'r test'
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1e = inr%re()
  outr = int1e%er()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)   write (*,*) 'r%re() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%er()-r%re() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1o = inr%ro()
  outr = int1o%or()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)   write (*,*) 'r%ro() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%or()-r%ro() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1a = inr%ra()
  outr = int1a%ar()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)   write (*,*) 'r%ra() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ar()-r%ra() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1q = inr%rq()
  outr = int1q%qr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)   write (*,*) 'r%rq() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qr()-r%rq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1h = inr%rh()
  outr = int1h%hr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)   write (*,*) 'r%rh() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hr()-r%rh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1c = inr%rc()
  outr = int1c%cr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)   write (*,*) 'r%rc() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cr()-r%rc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1s = inr%rs()
  outr = int1s%sr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)   write (*,*) 'r%rs() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sr()-r%rs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1v = inr%rv()
  outr = int1v%vr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)   write (*,*) 'r%rv() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vr()-r%rv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose)  write (*,*) 'q test'
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1e = inq%qe()
  outq = int1e%eq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)   write (*,*) 'q%qe() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eq()-q%qe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1o = inq%qo()
  outq = int1o%oq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)   write (*,*) 'q%qo() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oq()-q%qo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1a = inq%qa()
  outq = int1a%aq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)   write (*,*) 'q%qa() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%aq()-q%qa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1r = inq%qr()
  outq = int1r%rq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)   write (*,*) 'q%qr() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rq()-q%qr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1h = inq%qh()
  outq = int1h%hq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)   write (*,*) 'q%qh() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hq()-q%qh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1c = inq%qc()
  outq = int1c%cq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)   write (*,*) 'q%qc() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cq()-q%qc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1s = inq%qs()
  outq = int1s%sq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)   write (*,*) 'q%qs() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sq()-q%qs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1v = inq%qv()
  outq = int1v%vq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)   write (*,*) 'q%qv() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vq()-q%qv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose)  write (*,*) 'h test'
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1e = inh%he()
  outh = int1e%eh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)   write (*,*) 'h%he() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eh()-h%he() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1o = inh%ho()
  outh = int1o%oh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)   write (*,*) 'h%ho() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oh()-h%ho() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1a = inh%ha()
  outh = int1a%ah()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)   write (*,*) 'h%ha() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ah()-h%ha() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1r = inh%hr()
  outh = int1r%rh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)   write (*,*) 'h%hr() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rh()-h%hr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1q = inh%hq()
  outh = int1q%qh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)   write (*,*) 'h%hq() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qh()-h%hq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1c = inh%hc()
  outh = int1c%ch()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)   write (*,*) 'h%hc() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ch()-h%hc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1s = inh%hs()
  outh = int1s%sh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)   write (*,*) 'h%hs() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sh()-h%hs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1v = inh%hv()
  outh = int1v%vh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)   write (*,*) 'h%hv() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vh()-h%hv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose)  write (*,*) 'c test'
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1e = inc%ce()
  outc = int1e%ec()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)   write (*,*) 'c%ce() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ec()-c%ce() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1o = inc%co()
  outc = int1o%oc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)   write (*,*) 'c%co() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oc()-c%co() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1a = inc%ca()
  outc = int1a%ac()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)   write (*,*) 'c%ca() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ac()-c%ca() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1r = inc%cr()
  outc = int1r%rc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)   write (*,*) 'c%cr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rc()-c%cr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1q = inc%cq()
  outc = int1q%qc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)   write (*,*) 'c%cq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qc()-c%cq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1h = inc%ch()
  outc = int1h%hc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)   write (*,*) 'c%ch() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hc()-c%ch() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1s = inc%cs()
  outc = int1s%sc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)   write (*,*) 'c%cs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sc()-c%cs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1v = inc%cv()
  outc = int1v%vc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)   write (*,*) 'c%cv() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vc()-c%cv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose)  write (*,*) 's test'
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1e = ins%se()
  outs = int1e%es()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)   write (*,*) 's%se() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%es()-s%se() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1o = ins%so()
  outs = int1o%os()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)   write (*,*) 's%so() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%os()-s%so() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1a = ins%sa()
  outs = int1a%as()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)   write (*,*) 's%sa() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%as()-s%sa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1r = ins%sr()
  outs = int1r%rs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)   write (*,*) 's%sr() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rs()-s%sr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1q = ins%sq()
  outs = int1q%qs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)   write (*,*) 's%sq() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qs()-s%sq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1h = ins%sh()
  outs = int1h%hs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)   write (*,*) 's%sh() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hs()-s%sh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1c = ins%sc()
  outs = int1c%cs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)   write (*,*) 's%sc() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cs()-s%sc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1v = ins%sv()
  outs = int1v%vs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)   write (*,*) 's%sv() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vs()-s%sv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose)  write (*,*) 'v test'
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1e = inv%ve()
  outv = int1e%ev()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)   write (*,*) 'v%ve() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ev()-v%ve() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1o = inv%vo()
  outv = int1o%ov()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)   write (*,*) 'v%vo() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%ov()-v%vo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1a = inv%va()
  outv = int1a%av()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)   write (*,*) 'v%va() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%av()-v%va() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1r = inv%vr()
  outv = int1r%rv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)   write (*,*) 'v%vr() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rv()-v%vr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1q = inv%vq()
  outv = int1q%qv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)   write (*,*) 'v%vq() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qv()-v%vq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1h = inv%vh()
  outv = int1h%hv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)   write (*,*) 'v%vh() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hv()-v%vh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1c = inv%vc()
  outv = int1c%cv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)   write (*,*) 'v%vc() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cv()-v%vc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1s = inv%vs()
  outv = int1s%sv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)   write (*,*) 'v%vs() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sv()-v%vs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
 if (verbose) write (*,*) ' Maximum difference in pairwise tests  : ', diffmax
 
!==================================================================
!==================================================================
! triple tests 
!==================================================================
!==================================================================
 
  diffmax = 0.D0
  tcnt = 0
if (verbose) write (*,*) 'triple e test'
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1o = ine%eo()
  int2a = int1o%oa()
  oute = int2a%ae()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'a%ae()-o%oa()-e%eo() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ae()-o%oa()-e%eo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1o = ine%eo()
  int2r = int1o%or()
  oute = int2r%re()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'r%re()-o%or()-e%eo() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%re()-o%or()-e%eo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1o = ine%eo()
  int2q = int1o%oq()
  oute = int2q%qe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'q%qe()-o%oq()-e%eo() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qe()-o%oq()-e%eo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1o = ine%eo()
  int2h = int1o%oh()
  oute = int2h%he()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'h%he()-o%oh()-e%eo() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%he()-o%oh()-e%eo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1o = ine%eo()
  int2c = int1o%oc()
  oute = int2c%ce()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'c%ce()-o%oc()-e%eo() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ce()-o%oc()-e%eo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1o = ine%eo()
  int2s = int1o%os()
  oute = int2s%se()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 's%se()-o%os()-e%eo() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%se()-o%os()-e%eo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1o = ine%eo()
  int2v = int1o%ov()
  oute = int2v%ve()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'v%ve()-o%ov()-e%eo() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%ve()-o%ov()-e%eo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1a = ine%ea()
  int2o = int1a%ao()
  oute = int2o%oe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'o%oe()-a%ao()-e%ea() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oe()-a%ao()-e%ea() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1a = ine%ea()
  int2r = int1a%ar()
  oute = int2r%re()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'r%re()-a%ar()-e%ea() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%re()-a%ar()-e%ea() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1a = ine%ea()
  int2q = int1a%aq()
  oute = int2q%qe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'q%qe()-a%aq()-e%ea() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qe()-a%aq()-e%ea() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1a = ine%ea()
  int2h = int1a%ah()
  oute = int2h%he()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'h%he()-a%ah()-e%ea() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%he()-a%ah()-e%ea() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1a = ine%ea()
  int2c = int1a%ac()
  oute = int2c%ce()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'c%ce()-a%ac()-e%ea() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ce()-a%ac()-e%ea() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1a = ine%ea()
  int2s = int1a%as()
  oute = int2s%se()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 's%se()-a%as()-e%ea() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%se()-a%as()-e%ea() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1a = ine%ea()
  int2v = int1a%av()
  oute = int2v%ve()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'v%ve()-a%av()-e%ea() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%ve()-a%av()-e%ea() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1r = ine%er()
  int2o = int1r%ro()
  oute = int2o%oe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'o%oe()-r%ro()-e%er() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oe()-r%ro()-e%er() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1r = ine%er()
  int2a = int1r%ra()
  oute = int2a%ae()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'a%ae()-r%ra()-e%er() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ae()-r%ra()-e%er() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1r = ine%er()
  int2q = int1r%rq()
  oute = int2q%qe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'q%qe()-r%rq()-e%er() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qe()-r%rq()-e%er() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1r = ine%er()
  int2h = int1r%rh()
  oute = int2h%he()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'h%he()-r%rh()-e%er() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%he()-r%rh()-e%er() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1r = ine%er()
  int2c = int1r%rc()
  oute = int2c%ce()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'c%ce()-r%rc()-e%er() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ce()-r%rc()-e%er() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1r = ine%er()
  int2s = int1r%rs()
  oute = int2s%se()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 's%se()-r%rs()-e%er() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%se()-r%rs()-e%er() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1r = ine%er()
  int2v = int1r%rv()
  oute = int2v%ve()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'v%ve()-r%rv()-e%er() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%ve()-r%rv()-e%er() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1q = ine%eq()
  int2o = int1q%qo()
  oute = int2o%oe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'o%oe()-q%qo()-e%eq() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oe()-q%qo()-e%eq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1q = ine%eq()
  int2a = int1q%qa()
  oute = int2a%ae()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'a%ae()-q%qa()-e%eq() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ae()-q%qa()-e%eq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1q = ine%eq()
  int2r = int1q%qr()
  oute = int2r%re()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'r%re()-q%qr()-e%eq() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%re()-q%qr()-e%eq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1q = ine%eq()
  int2h = int1q%qh()
  oute = int2h%he()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'h%he()-q%qh()-e%eq() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%he()-q%qh()-e%eq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1q = ine%eq()
  int2c = int1q%qc()
  oute = int2c%ce()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'c%ce()-q%qc()-e%eq() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ce()-q%qc()-e%eq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1q = ine%eq()
  int2s = int1q%qs()
  oute = int2s%se()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 's%se()-q%qs()-e%eq() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%se()-q%qs()-e%eq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1q = ine%eq()
  int2v = int1q%qv()
  oute = int2v%ve()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'v%ve()-q%qv()-e%eq() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%ve()-q%qv()-e%eq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1h = ine%eh()
  int2o = int1h%ho()
  oute = int2o%oe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'o%oe()-h%ho()-e%eh() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oe()-h%ho()-e%eh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1h = ine%eh()
  int2a = int1h%ha()
  oute = int2a%ae()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'a%ae()-h%ha()-e%eh() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ae()-h%ha()-e%eh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1h = ine%eh()
  int2r = int1h%hr()
  oute = int2r%re()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'r%re()-h%hr()-e%eh() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%re()-h%hr()-e%eh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1h = ine%eh()
  int2q = int1h%hq()
  oute = int2q%qe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'q%qe()-h%hq()-e%eh() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qe()-h%hq()-e%eh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1h = ine%eh()
  int2c = int1h%hc()
  oute = int2c%ce()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'c%ce()-h%hc()-e%eh() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ce()-h%hc()-e%eh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1h = ine%eh()
  int2s = int1h%hs()
  oute = int2s%se()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 's%se()-h%hs()-e%eh() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%se()-h%hs()-e%eh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1h = ine%eh()
  int2v = int1h%hv()
  oute = int2v%ve()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'v%ve()-h%hv()-e%eh() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%ve()-h%hv()-e%eh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1c = ine%ec()
  int2o = int1c%co()
  oute = int2o%oe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'o%oe()-c%co()-e%ec() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oe()-c%co()-e%ec() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1c = ine%ec()
  int2a = int1c%ca()
  oute = int2a%ae()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'a%ae()-c%ca()-e%ec() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ae()-c%ca()-e%ec() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1c = ine%ec()
  int2r = int1c%cr()
  oute = int2r%re()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'r%re()-c%cr()-e%ec() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%re()-c%cr()-e%ec() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1c = ine%ec()
  int2q = int1c%cq()
  oute = int2q%qe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'q%qe()-c%cq()-e%ec() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qe()-c%cq()-e%ec() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1c = ine%ec()
  int2h = int1c%ch()
  oute = int2h%he()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'h%he()-c%ch()-e%ec() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%he()-c%ch()-e%ec() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1c = ine%ec()
  int2s = int1c%cs()
  oute = int2s%se()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 's%se()-c%cs()-e%ec() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%se()-c%cs()-e%ec() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1c = ine%ec()
  int2v = int1c%cv()
  oute = int2v%ve()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'v%ve()-c%cv()-e%ec() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%ve()-c%cv()-e%ec() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1s = ine%es()
  int2o = int1s%so()
  oute = int2o%oe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'o%oe()-s%so()-e%es() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oe()-s%so()-e%es() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1s = ine%es()
  int2a = int1s%sa()
  oute = int2a%ae()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'a%ae()-s%sa()-e%es() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ae()-s%sa()-e%es() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1s = ine%es()
  int2r = int1s%sr()
  oute = int2r%re()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'r%re()-s%sr()-e%es() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%re()-s%sr()-e%es() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1s = ine%es()
  int2q = int1s%sq()
  oute = int2q%qe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'q%qe()-s%sq()-e%es() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qe()-s%sq()-e%es() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1s = ine%es()
  int2h = int1s%sh()
  oute = int2h%he()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'h%he()-s%sh()-e%es() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%he()-s%sh()-e%es() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1s = ine%es()
  int2c = int1s%sc()
  oute = int2c%ce()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'c%ce()-s%sc()-e%es() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ce()-s%sc()-e%es() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1s = ine%es()
  int2v = int1s%sv()
  oute = int2v%ve()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'v%ve()-s%sv()-e%es() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%ve()-s%sv()-e%es() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1v = ine%ev()
  int2o = int1v%vo()
  oute = int2o%oe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'o%oe()-v%vo()-e%ev() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oe()-v%vo()-e%ev() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1v = ine%ev()
  int2a = int1v%va()
  oute = int2a%ae()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'a%ae()-v%va()-e%ev() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ae()-v%va()-e%ev() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1v = ine%ev()
  int2r = int1v%vr()
  oute = int2r%re()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'r%re()-v%vr()-e%ev() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%re()-v%vr()-e%ev() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1v = ine%ev()
  int2q = int1v%vq()
  oute = int2q%qe()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'q%qe()-v%vq()-e%ev() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qe()-v%vq()-e%ev() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1v = ine%ev()
  int2h = int1v%vh()
  oute = int2h%he()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'h%he()-v%vh()-e%ev() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%he()-v%vh()-e%ev() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1v = ine%ev()
  int2c = int1v%vc()
  oute = int2c%ce()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 'c%ce()-v%vc()-e%ev() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ce()-v%vc()-e%ev() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ine = ot%getClass_e()
  int1v = ine%ev()
  int2s = int1v%vs()
  oute = int2s%se()
  oo = oute%eo()
  omm = oo%o_copyd()
  diff = maxval(abs(omm-ot%get_od()))
  if (verbose)  write (*,*) 's%se()-v%vs()-e%ev() max om difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%se()-v%vs()-e%ev() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose) write (*,*) 'triple o test'
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1e = ino%oe()
  int2a = int1e%ea()
  outo = int2a%ao()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'a%ao()-e%ea()-o%oe() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ao()-e%ea()-o%oe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1e = ino%oe()
  int2r = int1e%er()
  outo = int2r%ro()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'r%ro()-e%er()-o%oe() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ro()-e%er()-o%oe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1e = ino%oe()
  int2q = int1e%eq()
  outo = int2q%qo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'q%qo()-e%eq()-o%oe() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qo()-e%eq()-o%oe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1e = ino%oe()
  int2h = int1e%eh()
  outo = int2h%ho()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'h%ho()-e%eh()-o%oe() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ho()-e%eh()-o%oe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1e = ino%oe()
  int2c = int1e%ec()
  outo = int2c%co()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'c%co()-e%ec()-o%oe() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%co()-e%ec()-o%oe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1e = ino%oe()
  int2s = int1e%es()
  outo = int2s%so()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 's%so()-e%es()-o%oe() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%so()-e%es()-o%oe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1e = ino%oe()
  int2v = int1e%ev()
  outo = int2v%vo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'v%vo()-e%ev()-o%oe() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vo()-e%ev()-o%oe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1a = ino%oa()
  int2e = int1a%ae()
  outo = int2e%eo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'e%eo()-a%ae()-o%oa() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eo()-a%ae()-o%oa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1a = ino%oa()
  int2r = int1a%ar()
  outo = int2r%ro()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'r%ro()-a%ar()-o%oa() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ro()-a%ar()-o%oa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1a = ino%oa()
  int2q = int1a%aq()
  outo = int2q%qo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'q%qo()-a%aq()-o%oa() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qo()-a%aq()-o%oa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1a = ino%oa()
  int2h = int1a%ah()
  outo = int2h%ho()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'h%ho()-a%ah()-o%oa() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ho()-a%ah()-o%oa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1a = ino%oa()
  int2c = int1a%ac()
  outo = int2c%co()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'c%co()-a%ac()-o%oa() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%co()-a%ac()-o%oa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1a = ino%oa()
  int2s = int1a%as()
  outo = int2s%so()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 's%so()-a%as()-o%oa() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%so()-a%as()-o%oa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1a = ino%oa()
  int2v = int1a%av()
  outo = int2v%vo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'v%vo()-a%av()-o%oa() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vo()-a%av()-o%oa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1r = ino%or()
  int2e = int1r%re()
  outo = int2e%eo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'e%eo()-r%re()-o%or() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eo()-r%re()-o%or() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1r = ino%or()
  int2a = int1r%ra()
  outo = int2a%ao()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'a%ao()-r%ra()-o%or() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ao()-r%ra()-o%or() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1r = ino%or()
  int2q = int1r%rq()
  outo = int2q%qo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'q%qo()-r%rq()-o%or() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qo()-r%rq()-o%or() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1r = ino%or()
  int2h = int1r%rh()
  outo = int2h%ho()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'h%ho()-r%rh()-o%or() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ho()-r%rh()-o%or() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1r = ino%or()
  int2c = int1r%rc()
  outo = int2c%co()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'c%co()-r%rc()-o%or() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%co()-r%rc()-o%or() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1r = ino%or()
  int2s = int1r%rs()
  outo = int2s%so()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 's%so()-r%rs()-o%or() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%so()-r%rs()-o%or() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1r = ino%or()
  int2v = int1r%rv()
  outo = int2v%vo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'v%vo()-r%rv()-o%or() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vo()-r%rv()-o%or() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1q = ino%oq()
  int2e = int1q%qe()
  outo = int2e%eo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'e%eo()-q%qe()-o%oq() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eo()-q%qe()-o%oq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1q = ino%oq()
  int2a = int1q%qa()
  outo = int2a%ao()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'a%ao()-q%qa()-o%oq() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ao()-q%qa()-o%oq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1q = ino%oq()
  int2r = int1q%qr()
  outo = int2r%ro()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'r%ro()-q%qr()-o%oq() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ro()-q%qr()-o%oq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1q = ino%oq()
  int2h = int1q%qh()
  outo = int2h%ho()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'h%ho()-q%qh()-o%oq() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ho()-q%qh()-o%oq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1q = ino%oq()
  int2c = int1q%qc()
  outo = int2c%co()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'c%co()-q%qc()-o%oq() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%co()-q%qc()-o%oq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1q = ino%oq()
  int2s = int1q%qs()
  outo = int2s%so()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 's%so()-q%qs()-o%oq() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%so()-q%qs()-o%oq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1q = ino%oq()
  int2v = int1q%qv()
  outo = int2v%vo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'v%vo()-q%qv()-o%oq() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vo()-q%qv()-o%oq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1h = ino%oh()
  int2e = int1h%he()
  outo = int2e%eo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'e%eo()-h%he()-o%oh() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eo()-h%he()-o%oh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1h = ino%oh()
  int2a = int1h%ha()
  outo = int2a%ao()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'a%ao()-h%ha()-o%oh() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ao()-h%ha()-o%oh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1h = ino%oh()
  int2r = int1h%hr()
  outo = int2r%ro()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'r%ro()-h%hr()-o%oh() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ro()-h%hr()-o%oh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1h = ino%oh()
  int2q = int1h%hq()
  outo = int2q%qo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'q%qo()-h%hq()-o%oh() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qo()-h%hq()-o%oh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1h = ino%oh()
  int2c = int1h%hc()
  outo = int2c%co()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'c%co()-h%hc()-o%oh() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%co()-h%hc()-o%oh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1h = ino%oh()
  int2s = int1h%hs()
  outo = int2s%so()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 's%so()-h%hs()-o%oh() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%so()-h%hs()-o%oh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1h = ino%oh()
  int2v = int1h%hv()
  outo = int2v%vo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'v%vo()-h%hv()-o%oh() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vo()-h%hv()-o%oh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1c = ino%oc()
  int2e = int1c%ce()
  outo = int2e%eo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'e%eo()-c%ce()-o%oc() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eo()-c%ce()-o%oc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1c = ino%oc()
  int2a = int1c%ca()
  outo = int2a%ao()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'a%ao()-c%ca()-o%oc() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ao()-c%ca()-o%oc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1c = ino%oc()
  int2r = int1c%cr()
  outo = int2r%ro()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'r%ro()-c%cr()-o%oc() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ro()-c%cr()-o%oc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1c = ino%oc()
  int2q = int1c%cq()
  outo = int2q%qo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'q%qo()-c%cq()-o%oc() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qo()-c%cq()-o%oc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1c = ino%oc()
  int2h = int1c%ch()
  outo = int2h%ho()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'h%ho()-c%ch()-o%oc() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ho()-c%ch()-o%oc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1c = ino%oc()
  int2s = int1c%cs()
  outo = int2s%so()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 's%so()-c%cs()-o%oc() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%so()-c%cs()-o%oc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1c = ino%oc()
  int2v = int1c%cv()
  outo = int2v%vo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'v%vo()-c%cv()-o%oc() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vo()-c%cv()-o%oc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1s = ino%os()
  int2e = int1s%se()
  outo = int2e%eo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'e%eo()-s%se()-o%os() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eo()-s%se()-o%os() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1s = ino%os()
  int2a = int1s%sa()
  outo = int2a%ao()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'a%ao()-s%sa()-o%os() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ao()-s%sa()-o%os() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1s = ino%os()
  int2r = int1s%sr()
  outo = int2r%ro()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'r%ro()-s%sr()-o%os() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ro()-s%sr()-o%os() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1s = ino%os()
  int2q = int1s%sq()
  outo = int2q%qo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'q%qo()-s%sq()-o%os() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qo()-s%sq()-o%os() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1s = ino%os()
  int2h = int1s%sh()
  outo = int2h%ho()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'h%ho()-s%sh()-o%os() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ho()-s%sh()-o%os() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1s = ino%os()
  int2c = int1s%sc()
  outo = int2c%co()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'c%co()-s%sc()-o%os() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%co()-s%sc()-o%os() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1s = ino%os()
  int2v = int1s%sv()
  outo = int2v%vo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'v%vo()-s%sv()-o%os() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vo()-s%sv()-o%os() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1v = ino%ov()
  int2e = int1v%ve()
  outo = int2e%eo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'e%eo()-v%ve()-o%ov() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eo()-v%ve()-o%ov() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1v = ino%ov()
  int2a = int1v%va()
  outo = int2a%ao()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'a%ao()-v%va()-o%ov() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ao()-v%va()-o%ov() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1v = ino%ov()
  int2r = int1v%vr()
  outo = int2r%ro()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'r%ro()-v%vr()-o%ov() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ro()-v%vr()-o%ov() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1v = ino%ov()
  int2q = int1v%vq()
  outo = int2q%qo()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'q%qo()-v%vq()-o%ov() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qo()-v%vq()-o%ov() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1v = ino%ov()
  int2h = int1v%vh()
  outo = int2h%ho()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'h%ho()-v%vh()-o%ov() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ho()-v%vh()-o%ov() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1v = ino%ov()
  int2c = int1v%vc()
  outo = int2c%co()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 'c%co()-v%vc()-o%ov() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%co()-v%vc()-o%ov() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ino = ot%getClass_o()
  int1v = ino%ov()
  int2s = int1v%vs()
  outo = int2s%so()
  diff = maxval(abs(outo%o_copyd()-ino%o_copyd()))
  if (verbose)  write (*,*) 's%so()-v%vs()-o%ov() max difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%so()-v%vs()-o%ov() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose) write (*,*) 'triple a test'
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1e = ina%ae()
  int2o = int1e%eo()
  outa = int2o%oa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'o%oa()-e%eo()-a%ae() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oa()-e%eo()-a%ae() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1e = ina%ae()
  int2r = int1e%er()
  outa = int2r%ra()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'r%ra()-e%er()-a%ae() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ra()-e%er()-a%ae() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1e = ina%ae()
  int2q = int1e%eq()
  outa = int2q%qa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'q%qa()-e%eq()-a%ae() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qa()-e%eq()-a%ae() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1e = ina%ae()
  int2h = int1e%eh()
  outa = int2h%ha()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'h%ha()-e%eh()-a%ae() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ha()-e%eh()-a%ae() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1e = ina%ae()
  int2c = int1e%ec()
  outa = int2c%ca()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'c%ca()-e%ec()-a%ae() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ca()-e%ec()-a%ae() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1e = ina%ae()
  int2s = int1e%es()
  outa = int2s%sa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 's%sa()-e%es()-a%ae() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sa()-e%es()-a%ae() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1e = ina%ae()
  int2v = int1e%ev()
  outa = int2v%va()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'v%va()-e%ev()-a%ae() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%va()-e%ev()-a%ae() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1o = ina%ao()
  int2e = int1o%oe()
  outa = int2e%ea()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'e%ea()-o%oe()-a%ao() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ea()-o%oe()-a%ao() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1o = ina%ao()
  int2r = int1o%or()
  outa = int2r%ra()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'r%ra()-o%or()-a%ao() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ra()-o%or()-a%ao() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1o = ina%ao()
  int2q = int1o%oq()
  outa = int2q%qa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'q%qa()-o%oq()-a%ao() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qa()-o%oq()-a%ao() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1o = ina%ao()
  int2h = int1o%oh()
  outa = int2h%ha()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'h%ha()-o%oh()-a%ao() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ha()-o%oh()-a%ao() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1o = ina%ao()
  int2c = int1o%oc()
  outa = int2c%ca()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'c%ca()-o%oc()-a%ao() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ca()-o%oc()-a%ao() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1o = ina%ao()
  int2s = int1o%os()
  outa = int2s%sa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 's%sa()-o%os()-a%ao() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sa()-o%os()-a%ao() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1o = ina%ao()
  int2v = int1o%ov()
  outa = int2v%va()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'v%va()-o%ov()-a%ao() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%va()-o%ov()-a%ao() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1r = ina%ar()
  int2e = int1r%re()
  outa = int2e%ea()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'e%ea()-r%re()-a%ar() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ea()-r%re()-a%ar() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1r = ina%ar()
  int2o = int1r%ro()
  outa = int2o%oa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'o%oa()-r%ro()-a%ar() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oa()-r%ro()-a%ar() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1r = ina%ar()
  int2q = int1r%rq()
  outa = int2q%qa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'q%qa()-r%rq()-a%ar() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qa()-r%rq()-a%ar() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1r = ina%ar()
  int2h = int1r%rh()
  outa = int2h%ha()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'h%ha()-r%rh()-a%ar() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ha()-r%rh()-a%ar() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1r = ina%ar()
  int2c = int1r%rc()
  outa = int2c%ca()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'c%ca()-r%rc()-a%ar() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ca()-r%rc()-a%ar() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1r = ina%ar()
  int2s = int1r%rs()
  outa = int2s%sa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 's%sa()-r%rs()-a%ar() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sa()-r%rs()-a%ar() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1r = ina%ar()
  int2v = int1r%rv()
  outa = int2v%va()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'v%va()-r%rv()-a%ar() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%va()-r%rv()-a%ar() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1q = ina%aq()
  int2e = int1q%qe()
  outa = int2e%ea()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'e%ea()-q%qe()-a%aq() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ea()-q%qe()-a%aq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1q = ina%aq()
  int2o = int1q%qo()
  outa = int2o%oa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'o%oa()-q%qo()-a%aq() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oa()-q%qo()-a%aq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1q = ina%aq()
  int2r = int1q%qr()
  outa = int2r%ra()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'r%ra()-q%qr()-a%aq() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ra()-q%qr()-a%aq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1q = ina%aq()
  int2h = int1q%qh()
  outa = int2h%ha()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'h%ha()-q%qh()-a%aq() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ha()-q%qh()-a%aq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1q = ina%aq()
  int2c = int1q%qc()
  outa = int2c%ca()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'c%ca()-q%qc()-a%aq() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ca()-q%qc()-a%aq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1q = ina%aq()
  int2s = int1q%qs()
  outa = int2s%sa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 's%sa()-q%qs()-a%aq() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sa()-q%qs()-a%aq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1q = ina%aq()
  int2v = int1q%qv()
  outa = int2v%va()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'v%va()-q%qv()-a%aq() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%va()-q%qv()-a%aq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1h = ina%ah()
  int2e = int1h%he()
  outa = int2e%ea()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'e%ea()-h%he()-a%ah() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ea()-h%he()-a%ah() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1h = ina%ah()
  int2o = int1h%ho()
  outa = int2o%oa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'o%oa()-h%ho()-a%ah() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oa()-h%ho()-a%ah() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1h = ina%ah()
  int2r = int1h%hr()
  outa = int2r%ra()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'r%ra()-h%hr()-a%ah() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ra()-h%hr()-a%ah() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1h = ina%ah()
  int2q = int1h%hq()
  outa = int2q%qa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'q%qa()-h%hq()-a%ah() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qa()-h%hq()-a%ah() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1h = ina%ah()
  int2c = int1h%hc()
  outa = int2c%ca()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'c%ca()-h%hc()-a%ah() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ca()-h%hc()-a%ah() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1h = ina%ah()
  int2s = int1h%hs()
  outa = int2s%sa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 's%sa()-h%hs()-a%ah() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sa()-h%hs()-a%ah() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1h = ina%ah()
  int2v = int1h%hv()
  outa = int2v%va()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'v%va()-h%hv()-a%ah() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%va()-h%hv()-a%ah() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1c = ina%ac()
  int2e = int1c%ce()
  outa = int2e%ea()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'e%ea()-c%ce()-a%ac() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ea()-c%ce()-a%ac() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1c = ina%ac()
  int2o = int1c%co()
  outa = int2o%oa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'o%oa()-c%co()-a%ac() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oa()-c%co()-a%ac() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1c = ina%ac()
  int2r = int1c%cr()
  outa = int2r%ra()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'r%ra()-c%cr()-a%ac() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ra()-c%cr()-a%ac() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1c = ina%ac()
  int2q = int1c%cq()
  outa = int2q%qa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'q%qa()-c%cq()-a%ac() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qa()-c%cq()-a%ac() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1c = ina%ac()
  int2h = int1c%ch()
  outa = int2h%ha()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'h%ha()-c%ch()-a%ac() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ha()-c%ch()-a%ac() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1c = ina%ac()
  int2s = int1c%cs()
  outa = int2s%sa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 's%sa()-c%cs()-a%ac() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sa()-c%cs()-a%ac() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1c = ina%ac()
  int2v = int1c%cv()
  outa = int2v%va()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'v%va()-c%cv()-a%ac() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%va()-c%cv()-a%ac() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1s = ina%as()
  int2e = int1s%se()
  outa = int2e%ea()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'e%ea()-s%se()-a%as() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ea()-s%se()-a%as() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1s = ina%as()
  int2o = int1s%so()
  outa = int2o%oa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'o%oa()-s%so()-a%as() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oa()-s%so()-a%as() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1s = ina%as()
  int2r = int1s%sr()
  outa = int2r%ra()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'r%ra()-s%sr()-a%as() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ra()-s%sr()-a%as() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1s = ina%as()
  int2q = int1s%sq()
  outa = int2q%qa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'q%qa()-s%sq()-a%as() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qa()-s%sq()-a%as() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1s = ina%as()
  int2h = int1s%sh()
  outa = int2h%ha()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'h%ha()-s%sh()-a%as() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ha()-s%sh()-a%as() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1s = ina%as()
  int2c = int1s%sc()
  outa = int2c%ca()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'c%ca()-s%sc()-a%as() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ca()-s%sc()-a%as() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1s = ina%as()
  int2v = int1s%sv()
  outa = int2v%va()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'v%va()-s%sv()-a%as() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%va()-s%sv()-a%as() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1v = ina%av()
  int2e = int1v%ve()
  outa = int2e%ea()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'e%ea()-v%ve()-a%av() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ea()-v%ve()-a%av() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1v = ina%av()
  int2o = int1v%vo()
  outa = int2o%oa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'o%oa()-v%vo()-a%av() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oa()-v%vo()-a%av() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1v = ina%av()
  int2r = int1v%vr()
  outa = int2r%ra()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'r%ra()-v%vr()-a%av() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%ra()-v%vr()-a%av() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1v = ina%av()
  int2q = int1v%vq()
  outa = int2q%qa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'q%qa()-v%vq()-a%av() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qa()-v%vq()-a%av() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1v = ina%av()
  int2h = int1v%vh()
  outa = int2h%ha()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'h%ha()-v%vh()-a%av() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%ha()-v%vh()-a%av() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1v = ina%av()
  int2c = int1v%vc()
  outa = int2c%ca()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 'c%ca()-v%vc()-a%av() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ca()-v%vc()-a%av() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ina = ot%getClass_a()
  int1v = ina%av()
  int2s = int1v%vs()
  outa = int2s%sa()
  ad = outa%a_copyd()
  ad2 = ot%get_ad()
  if ((ad(4)-cPi).lt.1.D-08) then
    diff = maxval(abs(ad(1:3))-abs(ad2(1:3)))
  else
    diff = maxval(abs(ad-ad2))
  end if 
  if (verbose)  write (*,*) 's%sa()-v%vs()-a%av() max ax difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sa()-v%vs()-a%av() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose) write (*,*) 'triple r test'
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1e = inr%re()
  int2o = int1e%eo()
  outr = int2o%or()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'o%or()-e%eo()-r%re() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%or()-e%eo()-r%re() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1e = inr%re()
  int2a = int1e%ea()
  outr = int2a%ar()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'a%ar()-e%ea()-r%re() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ar()-e%ea()-r%re() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1e = inr%re()
  int2q = int1e%eq()
  outr = int2q%qr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'q%qr()-e%eq()-r%re() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qr()-e%eq()-r%re() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1e = inr%re()
  int2h = int1e%eh()
  outr = int2h%hr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'h%hr()-e%eh()-r%re() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hr()-e%eh()-r%re() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1e = inr%re()
  int2c = int1e%ec()
  outr = int2c%cr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'c%cr()-e%ec()-r%re() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cr()-e%ec()-r%re() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1e = inr%re()
  int2s = int1e%es()
  outr = int2s%sr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 's%sr()-e%es()-r%re() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sr()-e%es()-r%re() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1e = inr%re()
  int2v = int1e%ev()
  outr = int2v%vr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'v%vr()-e%ev()-r%re() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vr()-e%ev()-r%re() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1o = inr%ro()
  int2e = int1o%oe()
  outr = int2e%er()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'e%er()-o%oe()-r%ro() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%er()-o%oe()-r%ro() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1o = inr%ro()
  int2a = int1o%oa()
  outr = int2a%ar()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'a%ar()-o%oa()-r%ro() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ar()-o%oa()-r%ro() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1o = inr%ro()
  int2q = int1o%oq()
  outr = int2q%qr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'q%qr()-o%oq()-r%ro() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qr()-o%oq()-r%ro() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1o = inr%ro()
  int2h = int1o%oh()
  outr = int2h%hr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'h%hr()-o%oh()-r%ro() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hr()-o%oh()-r%ro() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1o = inr%ro()
  int2c = int1o%oc()
  outr = int2c%cr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'c%cr()-o%oc()-r%ro() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cr()-o%oc()-r%ro() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1o = inr%ro()
  int2s = int1o%os()
  outr = int2s%sr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 's%sr()-o%os()-r%ro() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sr()-o%os()-r%ro() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1o = inr%ro()
  int2v = int1o%ov()
  outr = int2v%vr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'v%vr()-o%ov()-r%ro() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vr()-o%ov()-r%ro() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1a = inr%ra()
  int2e = int1a%ae()
  outr = int2e%er()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'e%er()-a%ae()-r%ra() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%er()-a%ae()-r%ra() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1a = inr%ra()
  int2o = int1a%ao()
  outr = int2o%or()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'o%or()-a%ao()-r%ra() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%or()-a%ao()-r%ra() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1a = inr%ra()
  int2q = int1a%aq()
  outr = int2q%qr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'q%qr()-a%aq()-r%ra() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qr()-a%aq()-r%ra() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1a = inr%ra()
  int2h = int1a%ah()
  outr = int2h%hr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'h%hr()-a%ah()-r%ra() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hr()-a%ah()-r%ra() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1a = inr%ra()
  int2c = int1a%ac()
  outr = int2c%cr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'c%cr()-a%ac()-r%ra() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cr()-a%ac()-r%ra() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1a = inr%ra()
  int2s = int1a%as()
  outr = int2s%sr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 's%sr()-a%as()-r%ra() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sr()-a%as()-r%ra() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1a = inr%ra()
  int2v = int1a%av()
  outr = int2v%vr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'v%vr()-a%av()-r%ra() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vr()-a%av()-r%ra() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1q = inr%rq()
  int2e = int1q%qe()
  outr = int2e%er()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'e%er()-q%qe()-r%rq() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%er()-q%qe()-r%rq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1q = inr%rq()
  int2o = int1q%qo()
  outr = int2o%or()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'o%or()-q%qo()-r%rq() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%or()-q%qo()-r%rq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1q = inr%rq()
  int2a = int1q%qa()
  outr = int2a%ar()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'a%ar()-q%qa()-r%rq() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ar()-q%qa()-r%rq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1q = inr%rq()
  int2h = int1q%qh()
  outr = int2h%hr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'h%hr()-q%qh()-r%rq() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hr()-q%qh()-r%rq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1q = inr%rq()
  int2c = int1q%qc()
  outr = int2c%cr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'c%cr()-q%qc()-r%rq() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cr()-q%qc()-r%rq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1q = inr%rq()
  int2s = int1q%qs()
  outr = int2s%sr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 's%sr()-q%qs()-r%rq() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sr()-q%qs()-r%rq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1q = inr%rq()
  int2v = int1q%qv()
  outr = int2v%vr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'v%vr()-q%qv()-r%rq() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vr()-q%qv()-r%rq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1h = inr%rh()
  int2e = int1h%he()
  outr = int2e%er()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'e%er()-h%he()-r%rh() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%er()-h%he()-r%rh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1h = inr%rh()
  int2o = int1h%ho()
  outr = int2o%or()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'o%or()-h%ho()-r%rh() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%or()-h%ho()-r%rh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1h = inr%rh()
  int2a = int1h%ha()
  outr = int2a%ar()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'a%ar()-h%ha()-r%rh() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ar()-h%ha()-r%rh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1h = inr%rh()
  int2q = int1h%hq()
  outr = int2q%qr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'q%qr()-h%hq()-r%rh() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qr()-h%hq()-r%rh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1h = inr%rh()
  int2c = int1h%hc()
  outr = int2c%cr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'c%cr()-h%hc()-r%rh() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cr()-h%hc()-r%rh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1h = inr%rh()
  int2s = int1h%hs()
  outr = int2s%sr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 's%sr()-h%hs()-r%rh() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sr()-h%hs()-r%rh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1h = inr%rh()
  int2v = int1h%hv()
  outr = int2v%vr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'v%vr()-h%hv()-r%rh() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vr()-h%hv()-r%rh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1c = inr%rc()
  int2e = int1c%ce()
  outr = int2e%er()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'e%er()-c%ce()-r%rc() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%er()-c%ce()-r%rc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1c = inr%rc()
  int2o = int1c%co()
  outr = int2o%or()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'o%or()-c%co()-r%rc() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%or()-c%co()-r%rc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1c = inr%rc()
  int2a = int1c%ca()
  outr = int2a%ar()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'a%ar()-c%ca()-r%rc() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ar()-c%ca()-r%rc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1c = inr%rc()
  int2q = int1c%cq()
  outr = int2q%qr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'q%qr()-c%cq()-r%rc() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qr()-c%cq()-r%rc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1c = inr%rc()
  int2h = int1c%ch()
  outr = int2h%hr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'h%hr()-c%ch()-r%rc() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hr()-c%ch()-r%rc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1c = inr%rc()
  int2s = int1c%cs()
  outr = int2s%sr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 's%sr()-c%cs()-r%rc() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sr()-c%cs()-r%rc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1c = inr%rc()
  int2v = int1c%cv()
  outr = int2v%vr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'v%vr()-c%cv()-r%rc() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vr()-c%cv()-r%rc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1s = inr%rs()
  int2e = int1s%se()
  outr = int2e%er()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'e%er()-s%se()-r%rs() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%er()-s%se()-r%rs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1s = inr%rs()
  int2o = int1s%so()
  outr = int2o%or()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'o%or()-s%so()-r%rs() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%or()-s%so()-r%rs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1s = inr%rs()
  int2a = int1s%sa()
  outr = int2a%ar()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'a%ar()-s%sa()-r%rs() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ar()-s%sa()-r%rs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1s = inr%rs()
  int2q = int1s%sq()
  outr = int2q%qr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'q%qr()-s%sq()-r%rs() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qr()-s%sq()-r%rs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1s = inr%rs()
  int2h = int1s%sh()
  outr = int2h%hr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'h%hr()-s%sh()-r%rs() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hr()-s%sh()-r%rs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1s = inr%rs()
  int2c = int1s%sc()
  outr = int2c%cr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'c%cr()-s%sc()-r%rs() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cr()-s%sc()-r%rs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1s = inr%rs()
  int2v = int1s%sv()
  outr = int2v%vr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'v%vr()-s%sv()-r%rs() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vr()-s%sv()-r%rs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1v = inr%rv()
  int2e = int1v%ve()
  outr = int2e%er()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'e%er()-v%ve()-r%rv() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%er()-v%ve()-r%rv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1v = inr%rv()
  int2o = int1v%vo()
  outr = int2o%or()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'o%or()-v%vo()-r%rv() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%or()-v%vo()-r%rv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1v = inr%rv()
  int2a = int1v%va()
  outr = int2a%ar()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'a%ar()-v%va()-r%rv() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ar()-v%va()-r%rv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1v = inr%rv()
  int2q = int1v%vq()
  outr = int2q%qr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'q%qr()-v%vq()-r%rv() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qr()-v%vq()-r%rv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1v = inr%rv()
  int2h = int1v%vh()
  outr = int2h%hr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'h%hr()-v%vh()-r%rv() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hr()-v%vh()-r%rv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1v = inr%rv()
  int2c = int1v%vc()
  outr = int2c%cr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 'c%cr()-v%vc()-r%rv() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cr()-v%vc()-r%rv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inr = ot%getClass_r()
  int1v = inr%rv()
  int2s = int1v%vs()
  outr = int2s%sr()
  rd = outr%r_copyd()
  rd2 = ot%get_rd()
  if (rd(4).eq.inftyd()) then
    diff = maxval(abs(rd(1:3))-abs(rd2(1:3)))
  else
    if (rd(4).eq.0.D0) then
      diff = abs(rd(4)-rd2(4))
    else
      diff = maxval(abs(rd-rd2))
    end if 
  end if 
  if (verbose)  write (*,*) 's%sr()-v%vs()-r%rv() max ro difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sr()-v%vs()-r%rv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose) write (*,*) 'triple q test'
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1e = inq%qe()
  int2o = int1e%eo()
  outq = int2o%oq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'o%oq()-e%eo()-q%qe() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oq()-e%eo()-q%qe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1e = inq%qe()
  int2a = int1e%ea()
  outq = int2a%aq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'a%aq()-e%ea()-q%qe() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%aq()-e%ea()-q%qe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1e = inq%qe()
  int2r = int1e%er()
  outq = int2r%rq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'r%rq()-e%er()-q%qe() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rq()-e%er()-q%qe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1e = inq%qe()
  int2h = int1e%eh()
  outq = int2h%hq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'h%hq()-e%eh()-q%qe() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hq()-e%eh()-q%qe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1e = inq%qe()
  int2c = int1e%ec()
  outq = int2c%cq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'c%cq()-e%ec()-q%qe() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cq()-e%ec()-q%qe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1e = inq%qe()
  int2s = int1e%es()
  outq = int2s%sq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 's%sq()-e%es()-q%qe() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sq()-e%es()-q%qe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1e = inq%qe()
  int2v = int1e%ev()
  outq = int2v%vq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'v%vq()-e%ev()-q%qe() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vq()-e%ev()-q%qe() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1o = inq%qo()
  int2e = int1o%oe()
  outq = int2e%eq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'e%eq()-o%oe()-q%qo() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eq()-o%oe()-q%qo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1o = inq%qo()
  int2a = int1o%oa()
  outq = int2a%aq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'a%aq()-o%oa()-q%qo() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%aq()-o%oa()-q%qo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1o = inq%qo()
  int2r = int1o%or()
  outq = int2r%rq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'r%rq()-o%or()-q%qo() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rq()-o%or()-q%qo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1o = inq%qo()
  int2h = int1o%oh()
  outq = int2h%hq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'h%hq()-o%oh()-q%qo() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hq()-o%oh()-q%qo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1o = inq%qo()
  int2c = int1o%oc()
  outq = int2c%cq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'c%cq()-o%oc()-q%qo() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cq()-o%oc()-q%qo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1o = inq%qo()
  int2s = int1o%os()
  outq = int2s%sq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 's%sq()-o%os()-q%qo() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sq()-o%os()-q%qo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1o = inq%qo()
  int2v = int1o%ov()
  outq = int2v%vq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'v%vq()-o%ov()-q%qo() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vq()-o%ov()-q%qo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1a = inq%qa()
  int2e = int1a%ae()
  outq = int2e%eq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'e%eq()-a%ae()-q%qa() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eq()-a%ae()-q%qa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1a = inq%qa()
  int2o = int1a%ao()
  outq = int2o%oq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'o%oq()-a%ao()-q%qa() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oq()-a%ao()-q%qa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1a = inq%qa()
  int2r = int1a%ar()
  outq = int2r%rq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'r%rq()-a%ar()-q%qa() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rq()-a%ar()-q%qa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1a = inq%qa()
  int2h = int1a%ah()
  outq = int2h%hq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'h%hq()-a%ah()-q%qa() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hq()-a%ah()-q%qa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1a = inq%qa()
  int2c = int1a%ac()
  outq = int2c%cq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'c%cq()-a%ac()-q%qa() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cq()-a%ac()-q%qa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1a = inq%qa()
  int2s = int1a%as()
  outq = int2s%sq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 's%sq()-a%as()-q%qa() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sq()-a%as()-q%qa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1a = inq%qa()
  int2v = int1a%av()
  outq = int2v%vq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'v%vq()-a%av()-q%qa() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vq()-a%av()-q%qa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1r = inq%qr()
  int2e = int1r%re()
  outq = int2e%eq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'e%eq()-r%re()-q%qr() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eq()-r%re()-q%qr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1r = inq%qr()
  int2o = int1r%ro()
  outq = int2o%oq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'o%oq()-r%ro()-q%qr() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oq()-r%ro()-q%qr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1r = inq%qr()
  int2a = int1r%ra()
  outq = int2a%aq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'a%aq()-r%ra()-q%qr() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%aq()-r%ra()-q%qr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1r = inq%qr()
  int2h = int1r%rh()
  outq = int2h%hq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'h%hq()-r%rh()-q%qr() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hq()-r%rh()-q%qr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1r = inq%qr()
  int2c = int1r%rc()
  outq = int2c%cq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'c%cq()-r%rc()-q%qr() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cq()-r%rc()-q%qr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1r = inq%qr()
  int2s = int1r%rs()
  outq = int2s%sq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 's%sq()-r%rs()-q%qr() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sq()-r%rs()-q%qr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1r = inq%qr()
  int2v = int1r%rv()
  outq = int2v%vq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'v%vq()-r%rv()-q%qr() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vq()-r%rv()-q%qr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1h = inq%qh()
  int2e = int1h%he()
  outq = int2e%eq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'e%eq()-h%he()-q%qh() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eq()-h%he()-q%qh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1h = inq%qh()
  int2o = int1h%ho()
  outq = int2o%oq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'o%oq()-h%ho()-q%qh() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oq()-h%ho()-q%qh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1h = inq%qh()
  int2a = int1h%ha()
  outq = int2a%aq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'a%aq()-h%ha()-q%qh() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%aq()-h%ha()-q%qh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1h = inq%qh()
  int2r = int1h%hr()
  outq = int2r%rq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'r%rq()-h%hr()-q%qh() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rq()-h%hr()-q%qh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1h = inq%qh()
  int2c = int1h%hc()
  outq = int2c%cq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'c%cq()-h%hc()-q%qh() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cq()-h%hc()-q%qh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1h = inq%qh()
  int2s = int1h%hs()
  outq = int2s%sq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 's%sq()-h%hs()-q%qh() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sq()-h%hs()-q%qh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1h = inq%qh()
  int2v = int1h%hv()
  outq = int2v%vq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'v%vq()-h%hv()-q%qh() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vq()-h%hv()-q%qh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1c = inq%qc()
  int2e = int1c%ce()
  outq = int2e%eq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'e%eq()-c%ce()-q%qc() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eq()-c%ce()-q%qc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1c = inq%qc()
  int2o = int1c%co()
  outq = int2o%oq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'o%oq()-c%co()-q%qc() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oq()-c%co()-q%qc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1c = inq%qc()
  int2a = int1c%ca()
  outq = int2a%aq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'a%aq()-c%ca()-q%qc() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%aq()-c%ca()-q%qc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1c = inq%qc()
  int2r = int1c%cr()
  outq = int2r%rq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'r%rq()-c%cr()-q%qc() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rq()-c%cr()-q%qc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1c = inq%qc()
  int2h = int1c%ch()
  outq = int2h%hq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'h%hq()-c%ch()-q%qc() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hq()-c%ch()-q%qc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1c = inq%qc()
  int2s = int1c%cs()
  outq = int2s%sq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 's%sq()-c%cs()-q%qc() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sq()-c%cs()-q%qc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1c = inq%qc()
  int2v = int1c%cv()
  outq = int2v%vq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'v%vq()-c%cv()-q%qc() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vq()-c%cv()-q%qc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1s = inq%qs()
  int2e = int1s%se()
  outq = int2e%eq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'e%eq()-s%se()-q%qs() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eq()-s%se()-q%qs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1s = inq%qs()
  int2o = int1s%so()
  outq = int2o%oq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'o%oq()-s%so()-q%qs() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oq()-s%so()-q%qs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1s = inq%qs()
  int2a = int1s%sa()
  outq = int2a%aq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'a%aq()-s%sa()-q%qs() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%aq()-s%sa()-q%qs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1s = inq%qs()
  int2r = int1s%sr()
  outq = int2r%rq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'r%rq()-s%sr()-q%qs() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rq()-s%sr()-q%qs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1s = inq%qs()
  int2h = int1s%sh()
  outq = int2h%hq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'h%hq()-s%sh()-q%qs() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hq()-s%sh()-q%qs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1s = inq%qs()
  int2c = int1s%sc()
  outq = int2c%cq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'c%cq()-s%sc()-q%qs() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cq()-s%sc()-q%qs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1s = inq%qs()
  int2v = int1s%sv()
  outq = int2v%vq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'v%vq()-s%sv()-q%qs() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vq()-s%sv()-q%qs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1v = inq%qv()
  int2e = int1v%ve()
  outq = int2e%eq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'e%eq()-v%ve()-q%qv() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eq()-v%ve()-q%qv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1v = inq%qv()
  int2o = int1v%vo()
  outq = int2o%oq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'o%oq()-v%vo()-q%qv() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oq()-v%vo()-q%qv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1v = inq%qv()
  int2a = int1v%va()
  outq = int2a%aq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'a%aq()-v%va()-q%qv() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%aq()-v%va()-q%qv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1v = inq%qv()
  int2r = int1v%vr()
  outq = int2r%rq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'r%rq()-v%vr()-q%qv() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rq()-v%vr()-q%qv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1v = inq%qv()
  int2h = int1v%vh()
  outq = int2h%hq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'h%hq()-v%vh()-q%qv() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hq()-v%vh()-q%qv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1v = inq%qv()
  int2c = int1v%vc()
  outq = int2c%cq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 'c%cq()-v%vc()-q%qv() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cq()-v%vc()-q%qv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inq = ot%getClass_q()
  int1v = inq%qv()
  int2s = int1v%vs()
  outq = int2s%sq()
  qd = outq%q_copyd()
  qd2 = ot%get_qd()
  if (abs(qd(1)).lt.1.D-08) then
    diff = maxval(abs(qd(2:4))-abs(qd2(2:4)))
  else
    diff = maxval(abs(qd-qd2))
  end if 
  if (verbose)  write (*,*) 's%sq()-v%vs()-q%qv() max qu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sq()-v%vs()-q%qv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose) write (*,*) 'triple h test'
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1e = inh%he()
  int2o = int1e%eo()
  outh = int2o%oh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'o%oh()-e%eo()-h%he() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oh()-e%eo()-h%he() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1e = inh%he()
  int2a = int1e%ea()
  outh = int2a%ah()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'a%ah()-e%ea()-h%he() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ah()-e%ea()-h%he() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1e = inh%he()
  int2r = int1e%er()
  outh = int2r%rh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'r%rh()-e%er()-h%he() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rh()-e%er()-h%he() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1e = inh%he()
  int2q = int1e%eq()
  outh = int2q%qh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'q%qh()-e%eq()-h%he() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qh()-e%eq()-h%he() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1e = inh%he()
  int2c = int1e%ec()
  outh = int2c%ch()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'c%ch()-e%ec()-h%he() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ch()-e%ec()-h%he() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1e = inh%he()
  int2s = int1e%es()
  outh = int2s%sh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 's%sh()-e%es()-h%he() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sh()-e%es()-h%he() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1e = inh%he()
  int2v = int1e%ev()
  outh = int2v%vh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'v%vh()-e%ev()-h%he() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vh()-e%ev()-h%he() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1o = inh%ho()
  int2e = int1o%oe()
  outh = int2e%eh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'e%eh()-o%oe()-h%ho() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eh()-o%oe()-h%ho() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1o = inh%ho()
  int2a = int1o%oa()
  outh = int2a%ah()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'a%ah()-o%oa()-h%ho() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ah()-o%oa()-h%ho() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1o = inh%ho()
  int2r = int1o%or()
  outh = int2r%rh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'r%rh()-o%or()-h%ho() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rh()-o%or()-h%ho() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1o = inh%ho()
  int2q = int1o%oq()
  outh = int2q%qh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'q%qh()-o%oq()-h%ho() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qh()-o%oq()-h%ho() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1o = inh%ho()
  int2c = int1o%oc()
  outh = int2c%ch()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'c%ch()-o%oc()-h%ho() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ch()-o%oc()-h%ho() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1o = inh%ho()
  int2s = int1o%os()
  outh = int2s%sh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 's%sh()-o%os()-h%ho() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sh()-o%os()-h%ho() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1o = inh%ho()
  int2v = int1o%ov()
  outh = int2v%vh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'v%vh()-o%ov()-h%ho() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vh()-o%ov()-h%ho() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1a = inh%ha()
  int2e = int1a%ae()
  outh = int2e%eh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'e%eh()-a%ae()-h%ha() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eh()-a%ae()-h%ha() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1a = inh%ha()
  int2o = int1a%ao()
  outh = int2o%oh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'o%oh()-a%ao()-h%ha() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oh()-a%ao()-h%ha() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1a = inh%ha()
  int2r = int1a%ar()
  outh = int2r%rh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'r%rh()-a%ar()-h%ha() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rh()-a%ar()-h%ha() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1a = inh%ha()
  int2q = int1a%aq()
  outh = int2q%qh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'q%qh()-a%aq()-h%ha() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qh()-a%aq()-h%ha() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1a = inh%ha()
  int2c = int1a%ac()
  outh = int2c%ch()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'c%ch()-a%ac()-h%ha() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ch()-a%ac()-h%ha() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1a = inh%ha()
  int2s = int1a%as()
  outh = int2s%sh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 's%sh()-a%as()-h%ha() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sh()-a%as()-h%ha() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1a = inh%ha()
  int2v = int1a%av()
  outh = int2v%vh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'v%vh()-a%av()-h%ha() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vh()-a%av()-h%ha() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1r = inh%hr()
  int2e = int1r%re()
  outh = int2e%eh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'e%eh()-r%re()-h%hr() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eh()-r%re()-h%hr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1r = inh%hr()
  int2o = int1r%ro()
  outh = int2o%oh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'o%oh()-r%ro()-h%hr() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oh()-r%ro()-h%hr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1r = inh%hr()
  int2a = int1r%ra()
  outh = int2a%ah()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'a%ah()-r%ra()-h%hr() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ah()-r%ra()-h%hr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1r = inh%hr()
  int2q = int1r%rq()
  outh = int2q%qh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'q%qh()-r%rq()-h%hr() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qh()-r%rq()-h%hr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1r = inh%hr()
  int2c = int1r%rc()
  outh = int2c%ch()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'c%ch()-r%rc()-h%hr() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ch()-r%rc()-h%hr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1r = inh%hr()
  int2s = int1r%rs()
  outh = int2s%sh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 's%sh()-r%rs()-h%hr() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sh()-r%rs()-h%hr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1r = inh%hr()
  int2v = int1r%rv()
  outh = int2v%vh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'v%vh()-r%rv()-h%hr() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vh()-r%rv()-h%hr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1q = inh%hq()
  int2e = int1q%qe()
  outh = int2e%eh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'e%eh()-q%qe()-h%hq() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eh()-q%qe()-h%hq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1q = inh%hq()
  int2o = int1q%qo()
  outh = int2o%oh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'o%oh()-q%qo()-h%hq() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oh()-q%qo()-h%hq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1q = inh%hq()
  int2a = int1q%qa()
  outh = int2a%ah()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'a%ah()-q%qa()-h%hq() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ah()-q%qa()-h%hq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1q = inh%hq()
  int2r = int1q%qr()
  outh = int2r%rh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'r%rh()-q%qr()-h%hq() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rh()-q%qr()-h%hq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1q = inh%hq()
  int2c = int1q%qc()
  outh = int2c%ch()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'c%ch()-q%qc()-h%hq() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ch()-q%qc()-h%hq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1q = inh%hq()
  int2s = int1q%qs()
  outh = int2s%sh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 's%sh()-q%qs()-h%hq() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sh()-q%qs()-h%hq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1q = inh%hq()
  int2v = int1q%qv()
  outh = int2v%vh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'v%vh()-q%qv()-h%hq() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vh()-q%qv()-h%hq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1c = inh%hc()
  int2e = int1c%ce()
  outh = int2e%eh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'e%eh()-c%ce()-h%hc() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eh()-c%ce()-h%hc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1c = inh%hc()
  int2o = int1c%co()
  outh = int2o%oh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'o%oh()-c%co()-h%hc() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oh()-c%co()-h%hc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1c = inh%hc()
  int2a = int1c%ca()
  outh = int2a%ah()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'a%ah()-c%ca()-h%hc() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ah()-c%ca()-h%hc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1c = inh%hc()
  int2r = int1c%cr()
  outh = int2r%rh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'r%rh()-c%cr()-h%hc() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rh()-c%cr()-h%hc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1c = inh%hc()
  int2q = int1c%cq()
  outh = int2q%qh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'q%qh()-c%cq()-h%hc() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qh()-c%cq()-h%hc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1c = inh%hc()
  int2s = int1c%cs()
  outh = int2s%sh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 's%sh()-c%cs()-h%hc() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sh()-c%cs()-h%hc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1c = inh%hc()
  int2v = int1c%cv()
  outh = int2v%vh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'v%vh()-c%cv()-h%hc() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vh()-c%cv()-h%hc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1s = inh%hs()
  int2e = int1s%se()
  outh = int2e%eh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'e%eh()-s%se()-h%hs() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eh()-s%se()-h%hs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1s = inh%hs()
  int2o = int1s%so()
  outh = int2o%oh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'o%oh()-s%so()-h%hs() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oh()-s%so()-h%hs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1s = inh%hs()
  int2a = int1s%sa()
  outh = int2a%ah()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'a%ah()-s%sa()-h%hs() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ah()-s%sa()-h%hs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1s = inh%hs()
  int2r = int1s%sr()
  outh = int2r%rh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'r%rh()-s%sr()-h%hs() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rh()-s%sr()-h%hs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1s = inh%hs()
  int2q = int1s%sq()
  outh = int2q%qh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'q%qh()-s%sq()-h%hs() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qh()-s%sq()-h%hs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1s = inh%hs()
  int2c = int1s%sc()
  outh = int2c%ch()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'c%ch()-s%sc()-h%hs() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ch()-s%sc()-h%hs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1s = inh%hs()
  int2v = int1s%sv()
  outh = int2v%vh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'v%vh()-s%sv()-h%hs() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vh()-s%sv()-h%hs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1v = inh%hv()
  int2e = int1v%ve()
  outh = int2e%eh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'e%eh()-v%ve()-h%hv() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%eh()-v%ve()-h%hv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1v = inh%hv()
  int2o = int1v%vo()
  outh = int2o%oh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'o%oh()-v%vo()-h%hv() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oh()-v%vo()-h%hv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1v = inh%hv()
  int2a = int1v%va()
  outh = int2a%ah()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'a%ah()-v%va()-h%hv() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ah()-v%va()-h%hv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1v = inh%hv()
  int2r = int1v%vr()
  outh = int2r%rh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'r%rh()-v%vr()-h%hv() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rh()-v%vr()-h%hv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1v = inh%hv()
  int2q = int1v%vq()
  outh = int2q%qh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'q%qh()-v%vq()-h%hv() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qh()-v%vq()-h%hv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1v = inh%hv()
  int2c = int1v%vc()
  outh = int2c%ch()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 'c%ch()-v%vc()-h%hv() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%ch()-v%vc()-h%hv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inh = ot%getClass_h()
  int1v = inh%hv()
  int2s = int1v%vs()
  outh = int2s%sh()
  hd = outh%h_copyd()
  aux = sqrt(sum(hd*hd))
  if (abs(aux-LPs%R1).lt.1.D-08) then
    diff = maxval(abs(hd)-abs(ot%get_hd()))
  else
    diff = maxval(abs(hd-ot%get_hd()))
  end if 
  if (verbose)  write (*,*) 's%sh()-v%vs()-h%hv() max ho difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sh()-v%vs()-h%hv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose) write (*,*) 'triple c test'
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1e = inc%ce()
  int2o = int1e%eo()
  outc = int2o%oc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'o%oc()-e%eo()-c%ce() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oc()-e%eo()-c%ce() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1e = inc%ce()
  int2a = int1e%ea()
  outc = int2a%ac()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'a%ac()-e%ea()-c%ce() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ac()-e%ea()-c%ce() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1e = inc%ce()
  int2r = int1e%er()
  outc = int2r%rc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'r%rc()-e%er()-c%ce() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rc()-e%er()-c%ce() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1e = inc%ce()
  int2q = int1e%eq()
  outc = int2q%qc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'q%qc()-e%eq()-c%ce() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qc()-e%eq()-c%ce() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1e = inc%ce()
  int2h = int1e%eh()
  outc = int2h%hc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'h%hc()-e%eh()-c%ce() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hc()-e%eh()-c%ce() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1e = inc%ce()
  int2s = int1e%es()
  outc = int2s%sc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 's%sc()-e%es()-c%ce() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sc()-e%es()-c%ce() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1e = inc%ce()
  int2v = int1e%ev()
  outc = int2v%vc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'v%vc()-e%ev()-c%ce() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vc()-e%ev()-c%ce() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1o = inc%co()
  int2e = int1o%oe()
  outc = int2e%ec()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'e%ec()-o%oe()-c%co() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ec()-o%oe()-c%co() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1o = inc%co()
  int2a = int1o%oa()
  outc = int2a%ac()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'a%ac()-o%oa()-c%co() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ac()-o%oa()-c%co() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1o = inc%co()
  int2r = int1o%or()
  outc = int2r%rc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'r%rc()-o%or()-c%co() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rc()-o%or()-c%co() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1o = inc%co()
  int2q = int1o%oq()
  outc = int2q%qc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'q%qc()-o%oq()-c%co() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qc()-o%oq()-c%co() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1o = inc%co()
  int2h = int1o%oh()
  outc = int2h%hc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'h%hc()-o%oh()-c%co() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hc()-o%oh()-c%co() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1o = inc%co()
  int2s = int1o%os()
  outc = int2s%sc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 's%sc()-o%os()-c%co() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sc()-o%os()-c%co() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1o = inc%co()
  int2v = int1o%ov()
  outc = int2v%vc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'v%vc()-o%ov()-c%co() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vc()-o%ov()-c%co() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1a = inc%ca()
  int2e = int1a%ae()
  outc = int2e%ec()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'e%ec()-a%ae()-c%ca() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ec()-a%ae()-c%ca() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1a = inc%ca()
  int2o = int1a%ao()
  outc = int2o%oc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'o%oc()-a%ao()-c%ca() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oc()-a%ao()-c%ca() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1a = inc%ca()
  int2r = int1a%ar()
  outc = int2r%rc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'r%rc()-a%ar()-c%ca() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rc()-a%ar()-c%ca() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1a = inc%ca()
  int2q = int1a%aq()
  outc = int2q%qc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'q%qc()-a%aq()-c%ca() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qc()-a%aq()-c%ca() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1a = inc%ca()
  int2h = int1a%ah()
  outc = int2h%hc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'h%hc()-a%ah()-c%ca() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hc()-a%ah()-c%ca() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1a = inc%ca()
  int2s = int1a%as()
  outc = int2s%sc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 's%sc()-a%as()-c%ca() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sc()-a%as()-c%ca() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1a = inc%ca()
  int2v = int1a%av()
  outc = int2v%vc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'v%vc()-a%av()-c%ca() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vc()-a%av()-c%ca() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1r = inc%cr()
  int2e = int1r%re()
  outc = int2e%ec()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'e%ec()-r%re()-c%cr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ec()-r%re()-c%cr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1r = inc%cr()
  int2o = int1r%ro()
  outc = int2o%oc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'o%oc()-r%ro()-c%cr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oc()-r%ro()-c%cr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1r = inc%cr()
  int2a = int1r%ra()
  outc = int2a%ac()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'a%ac()-r%ra()-c%cr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ac()-r%ra()-c%cr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1r = inc%cr()
  int2q = int1r%rq()
  outc = int2q%qc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'q%qc()-r%rq()-c%cr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qc()-r%rq()-c%cr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1r = inc%cr()
  int2h = int1r%rh()
  outc = int2h%hc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'h%hc()-r%rh()-c%cr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hc()-r%rh()-c%cr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1r = inc%cr()
  int2s = int1r%rs()
  outc = int2s%sc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 's%sc()-r%rs()-c%cr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sc()-r%rs()-c%cr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1r = inc%cr()
  int2v = int1r%rv()
  outc = int2v%vc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'v%vc()-r%rv()-c%cr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vc()-r%rv()-c%cr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1q = inc%cq()
  int2e = int1q%qe()
  outc = int2e%ec()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'e%ec()-q%qe()-c%cq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ec()-q%qe()-c%cq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1q = inc%cq()
  int2o = int1q%qo()
  outc = int2o%oc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'o%oc()-q%qo()-c%cq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oc()-q%qo()-c%cq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1q = inc%cq()
  int2a = int1q%qa()
  outc = int2a%ac()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'a%ac()-q%qa()-c%cq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ac()-q%qa()-c%cq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1q = inc%cq()
  int2r = int1q%qr()
  outc = int2r%rc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'r%rc()-q%qr()-c%cq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rc()-q%qr()-c%cq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1q = inc%cq()
  int2h = int1q%qh()
  outc = int2h%hc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'h%hc()-q%qh()-c%cq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hc()-q%qh()-c%cq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1q = inc%cq()
  int2s = int1q%qs()
  outc = int2s%sc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 's%sc()-q%qs()-c%cq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sc()-q%qs()-c%cq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1q = inc%cq()
  int2v = int1q%qv()
  outc = int2v%vc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'v%vc()-q%qv()-c%cq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vc()-q%qv()-c%cq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1h = inc%ch()
  int2e = int1h%he()
  outc = int2e%ec()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'e%ec()-h%he()-c%ch() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ec()-h%he()-c%ch() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1h = inc%ch()
  int2o = int1h%ho()
  outc = int2o%oc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'o%oc()-h%ho()-c%ch() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oc()-h%ho()-c%ch() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1h = inc%ch()
  int2a = int1h%ha()
  outc = int2a%ac()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'a%ac()-h%ha()-c%ch() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ac()-h%ha()-c%ch() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1h = inc%ch()
  int2r = int1h%hr()
  outc = int2r%rc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'r%rc()-h%hr()-c%ch() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rc()-h%hr()-c%ch() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1h = inc%ch()
  int2q = int1h%hq()
  outc = int2q%qc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'q%qc()-h%hq()-c%ch() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qc()-h%hq()-c%ch() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1h = inc%ch()
  int2s = int1h%hs()
  outc = int2s%sc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 's%sc()-h%hs()-c%ch() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sc()-h%hs()-c%ch() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1h = inc%ch()
  int2v = int1h%hv()
  outc = int2v%vc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'v%vc()-h%hv()-c%ch() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vc()-h%hv()-c%ch() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1s = inc%cs()
  int2e = int1s%se()
  outc = int2e%ec()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'e%ec()-s%se()-c%cs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ec()-s%se()-c%cs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1s = inc%cs()
  int2o = int1s%so()
  outc = int2o%oc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'o%oc()-s%so()-c%cs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oc()-s%so()-c%cs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1s = inc%cs()
  int2a = int1s%sa()
  outc = int2a%ac()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'a%ac()-s%sa()-c%cs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ac()-s%sa()-c%cs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1s = inc%cs()
  int2r = int1s%sr()
  outc = int2r%rc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'r%rc()-s%sr()-c%cs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rc()-s%sr()-c%cs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1s = inc%cs()
  int2q = int1s%sq()
  outc = int2q%qc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'q%qc()-s%sq()-c%cs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qc()-s%sq()-c%cs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1s = inc%cs()
  int2h = int1s%sh()
  outc = int2h%hc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'h%hc()-s%sh()-c%cs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hc()-s%sh()-c%cs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1s = inc%cs()
  int2v = int1s%sv()
  outc = int2v%vc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'v%vc()-s%sv()-c%cs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vc()-s%sv()-c%cs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1v = inc%cv()
  int2e = int1v%ve()
  outc = int2e%ec()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'e%ec()-v%ve()-c%cv() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ec()-v%ve()-c%cv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1v = inc%cv()
  int2o = int1v%vo()
  outc = int2o%oc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'o%oc()-v%vo()-c%cv() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%oc()-v%vo()-c%cv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1v = inc%cv()
  int2a = int1v%va()
  outc = int2a%ac()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'a%ac()-v%va()-c%cv() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%ac()-v%va()-c%cv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1v = inc%cv()
  int2r = int1v%vr()
  outc = int2r%rc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'r%rc()-v%vr()-c%cv() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rc()-v%vr()-c%cv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1v = inc%cv()
  int2q = int1v%vq()
  outc = int2q%qc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'q%qc()-v%vq()-c%cv() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qc()-v%vq()-c%cv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1v = inc%cv()
  int2h = int1v%vh()
  outc = int2h%hc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 'h%hc()-v%vh()-c%cv() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hc()-v%vh()-c%cv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inc = ot%getClass_c()
  int1v = inc%cv()
  int2s = int1v%vs()
  outc = int2s%sc()
  ccd = outc%c_copyd()
  aux = maxval(abs(ccd))
  if (abs(aux-LPs%ap*0.5).lt.1.D-08) then
    diff = maxval(abs(ccd)-abs(ot%get_cd()))
  else
    diff = maxval(abs(ccd-ot%get_cd()))
  end if 
  if (verbose)  write (*,*) 's%sc()-v%vs()-c%cv() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sc()-v%vs()-c%cv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose) write (*,*) 'triple s test'
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1e = ins%se()
  int2o = int1e%eo()
  outs = int2o%os()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'o%os()-e%eo()-s%se() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%os()-e%eo()-s%se() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1e = ins%se()
  int2a = int1e%ea()
  outs = int2a%as()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'a%as()-e%ea()-s%se() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%as()-e%ea()-s%se() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1e = ins%se()
  int2r = int1e%er()
  outs = int2r%rs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'r%rs()-e%er()-s%se() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rs()-e%er()-s%se() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1e = ins%se()
  int2q = int1e%eq()
  outs = int2q%qs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'q%qs()-e%eq()-s%se() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qs()-e%eq()-s%se() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1e = ins%se()
  int2h = int1e%eh()
  outs = int2h%hs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'h%hs()-e%eh()-s%se() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hs()-e%eh()-s%se() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1e = ins%se()
  int2c = int1e%ec()
  outs = int2c%cs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'c%cs()-e%ec()-s%se() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cs()-e%ec()-s%se() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1e = ins%se()
  int2v = int1e%ev()
  outs = int2v%vs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'v%vs()-e%ev()-s%se() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vs()-e%ev()-s%se() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1o = ins%so()
  int2e = int1o%oe()
  outs = int2e%es()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'e%es()-o%oe()-s%so() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%es()-o%oe()-s%so() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1o = ins%so()
  int2a = int1o%oa()
  outs = int2a%as()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'a%as()-o%oa()-s%so() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%as()-o%oa()-s%so() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1o = ins%so()
  int2r = int1o%or()
  outs = int2r%rs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'r%rs()-o%or()-s%so() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rs()-o%or()-s%so() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1o = ins%so()
  int2q = int1o%oq()
  outs = int2q%qs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'q%qs()-o%oq()-s%so() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qs()-o%oq()-s%so() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1o = ins%so()
  int2h = int1o%oh()
  outs = int2h%hs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'h%hs()-o%oh()-s%so() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hs()-o%oh()-s%so() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1o = ins%so()
  int2c = int1o%oc()
  outs = int2c%cs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'c%cs()-o%oc()-s%so() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cs()-o%oc()-s%so() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1o = ins%so()
  int2v = int1o%ov()
  outs = int2v%vs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'v%vs()-o%ov()-s%so() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vs()-o%ov()-s%so() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1a = ins%sa()
  int2e = int1a%ae()
  outs = int2e%es()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'e%es()-a%ae()-s%sa() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%es()-a%ae()-s%sa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1a = ins%sa()
  int2o = int1a%ao()
  outs = int2o%os()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'o%os()-a%ao()-s%sa() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%os()-a%ao()-s%sa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1a = ins%sa()
  int2r = int1a%ar()
  outs = int2r%rs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'r%rs()-a%ar()-s%sa() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rs()-a%ar()-s%sa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1a = ins%sa()
  int2q = int1a%aq()
  outs = int2q%qs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'q%qs()-a%aq()-s%sa() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qs()-a%aq()-s%sa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1a = ins%sa()
  int2h = int1a%ah()
  outs = int2h%hs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'h%hs()-a%ah()-s%sa() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hs()-a%ah()-s%sa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1a = ins%sa()
  int2c = int1a%ac()
  outs = int2c%cs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'c%cs()-a%ac()-s%sa() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cs()-a%ac()-s%sa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1a = ins%sa()
  int2v = int1a%av()
  outs = int2v%vs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'v%vs()-a%av()-s%sa() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vs()-a%av()-s%sa() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1r = ins%sr()
  int2e = int1r%re()
  outs = int2e%es()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'e%es()-r%re()-s%sr() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%es()-r%re()-s%sr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1r = ins%sr()
  int2o = int1r%ro()
  outs = int2o%os()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'o%os()-r%ro()-s%sr() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%os()-r%ro()-s%sr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1r = ins%sr()
  int2a = int1r%ra()
  outs = int2a%as()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'a%as()-r%ra()-s%sr() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%as()-r%ra()-s%sr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1r = ins%sr()
  int2q = int1r%rq()
  outs = int2q%qs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'q%qs()-r%rq()-s%sr() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qs()-r%rq()-s%sr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1r = ins%sr()
  int2h = int1r%rh()
  outs = int2h%hs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'h%hs()-r%rh()-s%sr() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hs()-r%rh()-s%sr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1r = ins%sr()
  int2c = int1r%rc()
  outs = int2c%cs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'c%cs()-r%rc()-s%sr() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cs()-r%rc()-s%sr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1r = ins%sr()
  int2v = int1r%rv()
  outs = int2v%vs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'v%vs()-r%rv()-s%sr() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vs()-r%rv()-s%sr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1q = ins%sq()
  int2e = int1q%qe()
  outs = int2e%es()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'e%es()-q%qe()-s%sq() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%es()-q%qe()-s%sq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1q = ins%sq()
  int2o = int1q%qo()
  outs = int2o%os()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'o%os()-q%qo()-s%sq() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%os()-q%qo()-s%sq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1q = ins%sq()
  int2a = int1q%qa()
  outs = int2a%as()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'a%as()-q%qa()-s%sq() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%as()-q%qa()-s%sq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1q = ins%sq()
  int2r = int1q%qr()
  outs = int2r%rs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'r%rs()-q%qr()-s%sq() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rs()-q%qr()-s%sq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1q = ins%sq()
  int2h = int1q%qh()
  outs = int2h%hs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'h%hs()-q%qh()-s%sq() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hs()-q%qh()-s%sq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1q = ins%sq()
  int2c = int1q%qc()
  outs = int2c%cs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'c%cs()-q%qc()-s%sq() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cs()-q%qc()-s%sq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1q = ins%sq()
  int2v = int1q%qv()
  outs = int2v%vs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'v%vs()-q%qv()-s%sq() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vs()-q%qv()-s%sq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1h = ins%sh()
  int2e = int1h%he()
  outs = int2e%es()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'e%es()-h%he()-s%sh() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%es()-h%he()-s%sh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1h = ins%sh()
  int2o = int1h%ho()
  outs = int2o%os()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'o%os()-h%ho()-s%sh() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%os()-h%ho()-s%sh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1h = ins%sh()
  int2a = int1h%ha()
  outs = int2a%as()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'a%as()-h%ha()-s%sh() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%as()-h%ha()-s%sh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1h = ins%sh()
  int2r = int1h%hr()
  outs = int2r%rs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'r%rs()-h%hr()-s%sh() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rs()-h%hr()-s%sh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1h = ins%sh()
  int2q = int1h%hq()
  outs = int2q%qs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'q%qs()-h%hq()-s%sh() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qs()-h%hq()-s%sh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1h = ins%sh()
  int2c = int1h%hc()
  outs = int2c%cs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'c%cs()-h%hc()-s%sh() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cs()-h%hc()-s%sh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1h = ins%sh()
  int2v = int1h%hv()
  outs = int2v%vs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'v%vs()-h%hv()-s%sh() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vs()-h%hv()-s%sh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1c = ins%sc()
  int2e = int1c%ce()
  outs = int2e%es()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'e%es()-c%ce()-s%sc() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%es()-c%ce()-s%sc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1c = ins%sc()
  int2o = int1c%co()
  outs = int2o%os()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'o%os()-c%co()-s%sc() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%os()-c%co()-s%sc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1c = ins%sc()
  int2a = int1c%ca()
  outs = int2a%as()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'a%as()-c%ca()-s%sc() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%as()-c%ca()-s%sc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1c = ins%sc()
  int2r = int1c%cr()
  outs = int2r%rs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'r%rs()-c%cr()-s%sc() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rs()-c%cr()-s%sc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1c = ins%sc()
  int2q = int1c%cq()
  outs = int2q%qs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'q%qs()-c%cq()-s%sc() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qs()-c%cq()-s%sc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1c = ins%sc()
  int2h = int1c%ch()
  outs = int2h%hs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'h%hs()-c%ch()-s%sc() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hs()-c%ch()-s%sc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1c = ins%sc()
  int2v = int1c%cv()
  outs = int2v%vs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'v%vs()-c%cv()-s%sc() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : v%vs()-c%cv()-s%sc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1v = ins%sv()
  int2e = int1v%ve()
  outs = int2e%es()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'e%es()-v%ve()-s%sv() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%es()-v%ve()-s%sv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1v = ins%sv()
  int2o = int1v%vo()
  outs = int2o%os()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'o%os()-v%vo()-s%sv() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%os()-v%vo()-s%sv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1v = ins%sv()
  int2a = int1v%va()
  outs = int2a%as()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'a%as()-v%va()-s%sv() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%as()-v%va()-s%sv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1v = ins%sv()
  int2r = int1v%vr()
  outs = int2r%rs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'r%rs()-v%vr()-s%sv() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rs()-v%vr()-s%sv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1v = ins%sv()
  int2q = int1v%vq()
  outs = int2q%qs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'q%qs()-v%vq()-s%sv() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qs()-v%vq()-s%sv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1v = ins%sv()
  int2h = int1v%vh()
  outs = int2h%hs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'h%hs()-v%vh()-s%sv() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hs()-v%vh()-s%sv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  ins = ot%getClass_s()
  int1v = ins%sv()
  int2c = int1v%vc()
  outs = int2c%cs()
  sd = outs%s_copyd()
  aux = sqrt(sum(sd*sd))
  if (abs(aux-1.D0).lt.1.D-08) then
    diff = maxval(abs(sd)-abs(ot%get_sd()))
  else
    diff = maxval(abs(sd-ot%get_sd()))
  end if 
  if (verbose)  write (*,*) 'c%cs()-v%vc()-s%sv() max st difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cs()-v%vc()-s%sv() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
if (verbose) write (*,*) 'triple v test'
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1e = inv%ve()
  int2o = int1e%eo()
  outv = int2o%ov()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'o%ov()-e%eo()-v%ve() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%ov()-e%eo()-v%ve() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1e = inv%ve()
  int2a = int1e%ea()
  outv = int2a%av()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'a%av()-e%ea()-v%ve() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%av()-e%ea()-v%ve() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1e = inv%ve()
  int2r = int1e%er()
  outv = int2r%rv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'r%rv()-e%er()-v%ve() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rv()-e%er()-v%ve() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1e = inv%ve()
  int2q = int1e%eq()
  outv = int2q%qv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'q%qv()-e%eq()-v%ve() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qv()-e%eq()-v%ve() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1e = inv%ve()
  int2h = int1e%eh()
  outv = int2h%hv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'h%hv()-e%eh()-v%ve() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hv()-e%eh()-v%ve() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1e = inv%ve()
  int2c = int1e%ec()
  outv = int2c%cv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'c%cv()-e%ec()-v%ve() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cv()-e%ec()-v%ve() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1e = inv%ve()
  int2s = int1e%es()
  outv = int2s%sv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 's%sv()-e%es()-v%ve() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sv()-e%es()-v%ve() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1o = inv%vo()
  int2e = int1o%oe()
  outv = int2e%ev()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'e%ev()-o%oe()-v%vo() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ev()-o%oe()-v%vo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1o = inv%vo()
  int2a = int1o%oa()
  outv = int2a%av()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'a%av()-o%oa()-v%vo() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%av()-o%oa()-v%vo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1o = inv%vo()
  int2r = int1o%or()
  outv = int2r%rv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'r%rv()-o%or()-v%vo() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rv()-o%or()-v%vo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1o = inv%vo()
  int2q = int1o%oq()
  outv = int2q%qv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'q%qv()-o%oq()-v%vo() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qv()-o%oq()-v%vo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1o = inv%vo()
  int2h = int1o%oh()
  outv = int2h%hv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'h%hv()-o%oh()-v%vo() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hv()-o%oh()-v%vo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1o = inv%vo()
  int2c = int1o%oc()
  outv = int2c%cv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'c%cv()-o%oc()-v%vo() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cv()-o%oc()-v%vo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1o = inv%vo()
  int2s = int1o%os()
  outv = int2s%sv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 's%sv()-o%os()-v%vo() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sv()-o%os()-v%vo() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1a = inv%va()
  int2e = int1a%ae()
  outv = int2e%ev()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'e%ev()-a%ae()-v%va() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ev()-a%ae()-v%va() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1a = inv%va()
  int2o = int1a%ao()
  outv = int2o%ov()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'o%ov()-a%ao()-v%va() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%ov()-a%ao()-v%va() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1a = inv%va()
  int2r = int1a%ar()
  outv = int2r%rv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'r%rv()-a%ar()-v%va() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rv()-a%ar()-v%va() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1a = inv%va()
  int2q = int1a%aq()
  outv = int2q%qv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'q%qv()-a%aq()-v%va() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qv()-a%aq()-v%va() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1a = inv%va()
  int2h = int1a%ah()
  outv = int2h%hv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'h%hv()-a%ah()-v%va() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hv()-a%ah()-v%va() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1a = inv%va()
  int2c = int1a%ac()
  outv = int2c%cv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'c%cv()-a%ac()-v%va() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cv()-a%ac()-v%va() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1a = inv%va()
  int2s = int1a%as()
  outv = int2s%sv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 's%sv()-a%as()-v%va() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sv()-a%as()-v%va() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1r = inv%vr()
  int2e = int1r%re()
  outv = int2e%ev()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'e%ev()-r%re()-v%vr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ev()-r%re()-v%vr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1r = inv%vr()
  int2o = int1r%ro()
  outv = int2o%ov()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'o%ov()-r%ro()-v%vr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%ov()-r%ro()-v%vr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1r = inv%vr()
  int2a = int1r%ra()
  outv = int2a%av()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'a%av()-r%ra()-v%vr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%av()-r%ra()-v%vr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1r = inv%vr()
  int2q = int1r%rq()
  outv = int2q%qv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'q%qv()-r%rq()-v%vr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qv()-r%rq()-v%vr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1r = inv%vr()
  int2h = int1r%rh()
  outv = int2h%hv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'h%hv()-r%rh()-v%vr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hv()-r%rh()-v%vr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1r = inv%vr()
  int2c = int1r%rc()
  outv = int2c%cv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'c%cv()-r%rc()-v%vr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cv()-r%rc()-v%vr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1r = inv%vr()
  int2s = int1r%rs()
  outv = int2s%sv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 's%sv()-r%rs()-v%vr() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sv()-r%rs()-v%vr() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1q = inv%vq()
  int2e = int1q%qe()
  outv = int2e%ev()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'e%ev()-q%qe()-v%vq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ev()-q%qe()-v%vq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1q = inv%vq()
  int2o = int1q%qo()
  outv = int2o%ov()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'o%ov()-q%qo()-v%vq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%ov()-q%qo()-v%vq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1q = inv%vq()
  int2a = int1q%qa()
  outv = int2a%av()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'a%av()-q%qa()-v%vq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%av()-q%qa()-v%vq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1q = inv%vq()
  int2r = int1q%qr()
  outv = int2r%rv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'r%rv()-q%qr()-v%vq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rv()-q%qr()-v%vq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1q = inv%vq()
  int2h = int1q%qh()
  outv = int2h%hv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'h%hv()-q%qh()-v%vq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hv()-q%qh()-v%vq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1q = inv%vq()
  int2c = int1q%qc()
  outv = int2c%cv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'c%cv()-q%qc()-v%vq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cv()-q%qc()-v%vq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1q = inv%vq()
  int2s = int1q%qs()
  outv = int2s%sv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 's%sv()-q%qs()-v%vq() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sv()-q%qs()-v%vq() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1h = inv%vh()
  int2e = int1h%he()
  outv = int2e%ev()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'e%ev()-h%he()-v%vh() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ev()-h%he()-v%vh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1h = inv%vh()
  int2o = int1h%ho()
  outv = int2o%ov()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'o%ov()-h%ho()-v%vh() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%ov()-h%ho()-v%vh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1h = inv%vh()
  int2a = int1h%ha()
  outv = int2a%av()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'a%av()-h%ha()-v%vh() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%av()-h%ha()-v%vh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1h = inv%vh()
  int2r = int1h%hr()
  outv = int2r%rv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'r%rv()-h%hr()-v%vh() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rv()-h%hr()-v%vh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1h = inv%vh()
  int2q = int1h%hq()
  outv = int2q%qv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'q%qv()-h%hq()-v%vh() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qv()-h%hq()-v%vh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1h = inv%vh()
  int2c = int1h%hc()
  outv = int2c%cv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'c%cv()-h%hc()-v%vh() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cv()-h%hc()-v%vh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1h = inv%vh()
  int2s = int1h%hs()
  outv = int2s%sv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 's%sv()-h%hs()-v%vh() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sv()-h%hs()-v%vh() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1c = inv%vc()
  int2e = int1c%ce()
  outv = int2e%ev()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'e%ev()-c%ce()-v%vc() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ev()-c%ce()-v%vc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1c = inv%vc()
  int2o = int1c%co()
  outv = int2o%ov()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'o%ov()-c%co()-v%vc() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%ov()-c%co()-v%vc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1c = inv%vc()
  int2a = int1c%ca()
  outv = int2a%av()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'a%av()-c%ca()-v%vc() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%av()-c%ca()-v%vc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1c = inv%vc()
  int2r = int1c%cr()
  outv = int2r%rv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'r%rv()-c%cr()-v%vc() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rv()-c%cr()-v%vc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1c = inv%vc()
  int2q = int1c%cq()
  outv = int2q%qv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'q%qv()-c%cq()-v%vc() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qv()-c%cq()-v%vc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1c = inv%vc()
  int2h = int1c%ch()
  outv = int2h%hv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'h%hv()-c%ch()-v%vc() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hv()-c%ch()-v%vc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1c = inv%vc()
  int2s = int1c%cs()
  outv = int2s%sv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 's%sv()-c%cs()-v%vc() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : s%sv()-c%cs()-v%vc() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1s = inv%vs()
  int2e = int1s%se()
  outv = int2e%ev()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'e%ev()-s%se()-v%vs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : e%ev()-s%se()-v%vs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1s = inv%vs()
  int2o = int1s%so()
  outv = int2o%ov()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'o%ov()-s%so()-v%vs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : o%ov()-s%so()-v%vs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1s = inv%vs()
  int2a = int1s%sa()
  outv = int2a%av()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'a%av()-s%sa()-v%vs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : a%av()-s%sa()-v%vs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1s = inv%vs()
  int2r = int1s%sr()
  outv = int2r%rv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'r%rv()-s%sr()-v%vs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : r%rv()-s%sr()-v%vs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1s = inv%vs()
  int2q = int1s%sq()
  outv = int2q%qv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'q%qv()-s%sq()-v%vs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : q%qv()-s%sq()-v%vs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1s = inv%vs()
  int2h = int1s%sh()
  outv = int2h%hv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'h%hv()-s%sh()-v%vs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : h%hv()-s%sh()-v%vs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
testcounter = testcounter + 1
  inv = ot%getClass_v()
  int1s = inv%vs()
  int2c = int1s%sc()
  outv = int2c%cv()
  vd = outv%v_copyd()
  aux = sqrt(sum(vd*vd))
  if (abs(aux-cPi).lt.1.D-07) then
    diff = maxval(abs(vd)-abs(ot%get_vd()))
  else
    diff = maxval(abs(vd-ot%get_vd()))
  end if 
  if (verbose)  write (*,*) 'c%cv()-s%sc()-v%vs() max cu difference = ', diff
  diffmax = maxval( (/ diffmax,diff /) )
 
  if (diffmax.gt.maxerr) then 
     testsfailed = testsfailed+1
     write (*,*) 'test # ',testcounter,' failed : c%cv()-s%sc()-v%vs() ',rots(1:3,i)
     res = testcounter
     return
  end if
 
 
 if (verbose) write (*,*) ' Maximum difference in triplet tests  : ', diffmax
end do mainloop
write (*,*) ' Total number of rotations tests executed = ',testcounter
write (*,*) ' Total number of rotations tests failed = ',testsfailed

end subroutine MODRotationsExecuteTest

end module MODRotationsTest
